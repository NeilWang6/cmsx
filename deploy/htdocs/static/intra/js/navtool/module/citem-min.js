var Citem=function(r){this.id=r;this.newitem={};this.fatherindex=[];this.fatherid=[];this.InitialHtml=function(b){b!=undefined&&jQuery(b)!=undefined?jQuery(b).append('<div id="cw" class="cw">                    \t<div class="cw-block">                        \t<div class="cw-categorylist">                            \t<h3 class="cw-categorylist-title">\u5bfc\u822a\u533a</h3>                            \t<ul id="cw-categorylist1" class="cw-categorylist-box ui-portlets">                                </ul>                                <div class="cw-categorylist-addbar">                                \t<div navtype="c" pid="cw-categorylist1" class="cw-categorylist-add cw-add-category"><span class="cw-categorylist-addtext">\u589e\u52a0\u7c7b\u76ee</span></div>                                    <div navtype="q" pid="cw-categorylist1" class="cw-categorylist-add cw-add-keyword"><span class="cw-categorylist-addtext">\u589e\u52a0\u5173\u952e\u8bcd</span></div>                                </div>                            </div>                            <div class="cw-categorylist">                            \t<h3 class="cw-categorylist-title">\u5bfc\u822a\u5757\uff1a<span id="cw-categorylist-2"></span></h3>                            \t<ul id="cw-categorylist2" class="cw-categorylist-box ui-portlets">                                </ul>                                <div class="cw-categorylist-addbar">                                \t<div navtype="c" pid="cw-categorylist2" class="cw-categorylist-add cw-add-category"><span class="cw-categorylist-addtext">\u589e\u52a0\u7c7b\u76ee</span></div>                                    <div navtype="q" pid="cw-categorylist2" class="cw-categorylist-add cw-add-keyword"><span class="cw-categorylist-addtext">\u589e\u52a0\u5173\u952e\u8bcd</span></div>                                </div>                            </div>                            <div class="cw-categorylist">                            \t<h3 class="cw-categorylist-title">\u7c7b\u76ee/\u5173\u952e\u5b57\uff1a<span id="cw-categorylist-3"></span></h3>                            \t<ul id="cw-categorylist3" class="cw-categorylist-box ui-portlets">                                </ul>                                <div class="cw-categorylist-addbar">                                \t<div navtype="c" pid="cw-categorylist3" class="cw-categorylist-add cw-add-category"><span class="cw-categorylist-addtext">\u589e\u52a0\u7c7b\u76ee</span></div>                                    <div navtype="q" pid="cw-categorylist3" class="cw-categorylist-add cw-add-keyword"><span class="cw-categorylist-addtext">\u589e\u52a0\u5173\u952e\u8bcd</span></div>                                </div>                            </div>                        </div>                        <hr class="cw-hr">                        <div class="cw-block">                        \t<div class="cw-hotkeylist">                            \t<h3 class="cw-categorylist-title">\u70ed\u641c\u8bcd\uff1a<span id="cw-hotkey-title"></span></h3>                                <ul id="cw-categorylist4" class="cw-categorylist-box ui-portlets">                                </ul>                                <div class="cw-categorylist-addbar">                                \t<div navtype="c" pid="cw-categorylist4" class="cw-categorylist-add  cw-add-category"><span class="cw-categorylist-addtext">\u589e\u52a0\u7c7b\u76ee</span></div>                                    <div navtype="q" pid="cw-categorylist4" class="cw-categorylist-add cw-add-keyword"><span class="cw-categorylist-addtext">\u589e\u52a0\u5173\u952e\u8bcd</span></div>                                </div>                            </div>                            <div class="cw-urlinfo">                            \t<h3 class="cw-categorylist-title">\u7f16\u8f91URL\u89c4\u5219<input type="hidden" id="isurlchanged" value="false"/></h3>                                <div class="cw-row">\u5bfc\u822a\u8def\u5f84\uff1a<span id="cw-guid-path"></span></div>                                <div class="cw-row">\u7c7b\u76ee\u540d\u79f0\uff1a<span id="cw-category-name" class="ank-categoryName"></span><input type="hidden" name="ank-categoryName" value="" id="cw-category-fullname"><input type="hidden" name="ank-categoryId" id="cw-category-nameid" value=""><span class="choose-category cw-item-icon-search">\u66f4\u6539</span><span class="delete-url-category cw-item-icon-deleteca">\u5220\u9664</span></div>                                <div class="cw-row fix-row">                                <div class="fd-left">\u641c\u7d22\u5173\u952e\u8bcd\uff1a<input type="text" id="cw-search-keyword" value="" class="cw-form-text"></div>                                <div class="fd-left">\u5c55\u793a\u5173\u952e\u8bcd\uff1a<input type="text" id="cw-show-keyword" value="" class="cw-form-text"></div>                                </div>                                <div class="cw-row fix-row">                                <div class="fd-left"> \u53c2\u6570(\u6807\u7b7e)\uff1a <input type="text" name="tagParam" class="define-param cw-form-text" value=""></div>                                <div class="fd-left">&nbsp;\u53c2\u6570(\u6253\u70b9)\uff1a <input type="text" name="tracelogParam" class="define-param cw-form-text" value=""></div>                                </div>                                <div class="cw-row">                                \t\u8f6c\u5411URL\uff1a&nbsp;                                    <select id="cw-switch-url" type="text">                                    \t<option value="1" selected="true">\u5927\u5e02\u573a</option>                                        <option value="2">\u5de5\u4e1a\u54c1\u8d85\u5e02</option>                                        <option value="3">\u539f\u6750\u6599</option>\t\t\t\t\t\t\t\t\t\t<option value="0">\u81ea\u5b9a\u4e49</option>\t\t\t\t\t\t\t\t\t\t</select>                                    <input type="text" id="cw-switch-custom-url" value="http://" class="cw-form-text">                                </div>                                <div class="cw-row">\u7279\u6b8a\u5c5e\u6027\uff1a                                \t<input type="checkbox" id="cw-url-iscolor" class="cw-form-checkbox">\u989c\u8272\u5b57\u4f53&nbsp;&nbsp;                                    <input type="checkbox" id="cw-url-isnew" class="cw-form-checkbox">"\u65b0"\u6807\u8bc6&nbsp;&nbsp;                                    <input type="checkbox" id="cw-url-ishot" class="cw-form-checkbox">"\u70ed"\u6807\u8bc6                                </div>                                <div class="cw-row">                                \t<input type="button" value="\u4fdd\u5b58" id="cw-form-button-add" class="cw-form-button">                                    <input type="button" value="\u91cd\u7f6e" id="cw-form-button-delete" class="cw-form-button">                                </div>                            </div>                        </div>                        <hr class="cw-hr">                        <div id="cw-block-foot" class="cw-block">                        \t<div class="cw-row">\t\t\t\t\t\t\t\t<input type="hidden" value="" id="pageId" name="pageId">                            \t<input type="button" value="\u9884\u89c8" id="cw-form-button-preview" class="cw-form-button">                                 <input type="button" value="\u5173\u95ed" id="cw-form-button-check" class="cw-form-button boxy-close">                            </div>                        </div>  \t\t\t\t\t</div>\t\t\t\t\t<div class="alert_dialog">ddsfsf</div>'):
jQuery("body").append('<div id="cw" class="cw">                    \t<div class="cw-block">                        \t<div class="cw-categorylist">                            \t<h3 class="cw-categorylist-title">\u5bfc\u822a\u533a</h3>                            \t<ul id="cw-categorylist1" class="cw-categorylist-box ui-portlets">                                </ul>                                <div class="cw-categorylist-addbar">                                \t<div navtype="c" pid="cw-categorylist1" class="cw-categorylist-add cw-add-category"><span class="cw-categorylist-addtext">\u589e\u52a0\u7c7b\u76ee</span></div>                                    <div navtype="q" pid="cw-categorylist1" class="cw-categorylist-add cw-add-keyword"><span class="cw-categorylist-addtext">\u589e\u52a0\u5173\u952e\u8bcd</span></div>                                </div>                            </div>                            <div class="cw-categorylist">                            \t<h3 class="cw-categorylist-title">\u5bfc\u822a\u5757\uff1a<span id="cw-categorylist-2"></span></h3>                            \t<ul id="cw-categorylist2" class="cw-categorylist-box ui-portlets">                                </ul>                                <div class="cw-categorylist-addbar">                                \t<div navtype="c" pid="cw-categorylist2" class="cw-categorylist-add cw-add-category"><span class="cw-categorylist-addtext">\u589e\u52a0\u7c7b\u76ee</span></div>                                    <div navtype="q" pid="cw-categorylist2" class="cw-categorylist-add cw-add-keyword"><span class="cw-categorylist-addtext">\u589e\u52a0\u5173\u952e\u8bcd</span></div>                                </div>                            </div>                            <div class="cw-categorylist">                            \t<h3 class="cw-categorylist-title">\u7c7b\u76ee/\u5173\u952e\u5b57\uff1a<span id="cw-categorylist-3"></span></h3>                            \t<ul id="cw-categorylist3" class="cw-categorylist-box ui-portlets">                                </ul>                                <div class="cw-categorylist-addbar">                                \t<div navtype="c" pid="cw-categorylist3" class="cw-categorylist-add cw-add-category"><span class="cw-categorylist-addtext">\u589e\u52a0\u7c7b\u76ee</span></div>                                    <div navtype="q" pid="cw-categorylist3" class="cw-categorylist-add cw-add-keyword"><span class="cw-categorylist-addtext">\u589e\u52a0\u5173\u952e\u8bcd</span></div>                                </div>                            </div>                        </div>                        <hr class="cw-hr">                        <div class="cw-block">                        \t<div class="cw-hotkeylist">                            \t<h3 class="cw-categorylist-title">\u70ed\u641c\u8bcd\uff1a<span id="cw-hotkey-title"></span></h3>                                <ul id="cw-categorylist4" class="cw-categorylist-box ui-portlets">                                </ul>                                <div class="cw-categorylist-addbar">                                \t<div navtype="c" pid="cw-categorylist4" class="cw-categorylist-add  cw-add-category"><span class="cw-categorylist-addtext">\u589e\u52a0\u7c7b\u76ee</span></div>                                    <div navtype="q" pid="cw-categorylist4" class="cw-categorylist-add cw-add-keyword"><span class="cw-categorylist-addtext">\u589e\u52a0\u5173\u952e\u8bcd</span></div>                                </div>                            </div>                            <div class="cw-urlinfo">                            \t<h3 class="cw-categorylist-title">\u7f16\u8f91URL\u89c4\u5219<input type="hidden" id="isurlchanged" value="false"/></h3>                                <div class="cw-row">\u5bfc\u822a\u8def\u5f84\uff1a<span id="cw-guid-path"></span></div>                                <div class="cw-row">\u7c7b\u76ee\u540d\u79f0\uff1a<span id="cw-category-name" class="ank-categoryName"></span><input type="hidden" name="ank-categoryName" value="" id="cw-category-fullname"><input type="hidden" name="ank-categoryId" id="cw-category-nameid" value=""><span class="choose-category cw-item-icon-search">\u66f4\u6539</span><span class="delete-url-category cw-item-icon-deleteca">\u5220\u9664</span></div>                                <div class="cw-row fix-row">                                <div class="fd-left">\u641c\u7d22\u5173\u952e\u8bcd\uff1a<input type="text" id="cw-search-keyword" value="" class="cw-form-text"></div>                                <div class="fd-left">\u5c55\u793a\u5173\u952e\u8bcd\uff1a<input type="text" id="cw-show-keyword" value="" class="cw-form-text"></div>                                </div>                                <div class="cw-row fix-row">                                <div class="fd-left"> \u53c2\u6570(\u6807\u7b7e)\uff1a <input type="text" name="tagParam" class="define-param cw-form-text" value=""></div>                                <div class="fd-left">&nbsp;\u53c2\u6570(\u6253\u70b9)\uff1a <input type="text" name="tracelogParam" class="define-param cw-form-text" value=""></div>                                </div>                                <div class="cw-row">                                \t\u8f6c\u5411URL\uff1a&nbsp;                                    <select id="cw-switch-url" type="text">                                    \t<option value="1" selected="true">\u5927\u5e02\u573a</option>                                        <option value="2">\u5de5\u4e1a\u54c1\u8d85\u5e02</option>                                        <option value="3">\u539f\u6750\u6599</option>\t\t\t\t\t\t\t\t\t\t<option value="0">\u81ea\u5b9a\u4e49</option>\t\t\t\t\t\t\t\t\t\t</select>                                    <input type="text" id="cw-switch-custom-url" value="http://" class="cw-form-text">                                </div>                                <div class="cw-row">\u7279\u6b8a\u5c5e\u6027\uff1a                                \t<input type="checkbox" id="cw-url-iscolor" class="cw-form-checkbox">\u989c\u8272\u5b57\u4f53&nbsp;&nbsp;                                    <input type="checkbox" id="cw-url-isnew" class="cw-form-checkbox">"\u65b0"\u6807\u8bc6&nbsp;&nbsp;                                    <input type="checkbox" id="cw-url-ishot" class="cw-form-checkbox">"\u70ed"\u6807\u8bc6                                </div>                                <div class="cw-row">                                \t<input type="button" value="\u4fdd\u5b58" id="cw-form-button-add" class="cw-form-button">                                    <input type="button" value="\u91cd\u7f6e" id="cw-form-button-delete" class="cw-form-button">                                </div>                            </div>                        </div>                        <hr class="cw-hr">                        <div id="cw-block-foot" class="cw-block">                        \t<div class="cw-row">\t\t\t\t\t\t\t\t<input type="hidden" value="" id="pageId" name="pageId">                            \t<input type="button" value="\u9884\u89c8" id="cw-form-button-preview" class="cw-form-button">                                 <input type="button" value="\u5173\u95ed" id="cw-form-button-check" class="cw-form-button boxy-close">                            </div>                        </div>  \t\t\t\t\t</div>\t\t\t\t\t<div class="alert_dialog">ddsfsf</div>')};
this.BindEvent=function(){jQuery("#cw-search-keyword").live("keyup",function(){jQuery("#cw-show-keyword").val(jQuery(this).val())});jQuery("li.cw-category-item").live("click",function(){var e=jQuery(".cw-item-selected").attr("cid"),h=new Citem(e);h.findCitemById();if(h.saveURL()===false)return false;if(jQuery(this).attr("cid")!=e){e=jQuery(this).attr("cid");h=new Citem(e);h.findCitemById();h.showSelected();h.showSelectButton();h.showChild();h.showURL();h.showHotkey();return false}});jQuery("span.cw-item-icon-delete").live("click",
function(){var e=jQuery(this).parent("li").attr("cid");e=new Citem(e);e.findCitemById();e.deleteItem();return false});jQuery("li.cw-category-item").live("mouseover",function(){var e=jQuery(this).attr("cid");(new Citem(e)).showDeleteButton()});jQuery(function(e){e.use("ui-portlets",function(){var h="",g=false;e(".cw-categorylist-box").portlets({items:">li",start:function(){h="";g=false},change:function(){g=true},stop:function(l,m){if(g){var f=m.currentItem.attr("cid");l=new Citem(f);m=jQuery("#elf_url").val();
l.findCitemById();h=l.postOrderId();jQuery.ajax({traditional:true,type:"post",url:m+"/tools/change_nav_order.do",data:h,cache:false,beforeSend:function(){},success:function(i){if(i=="OK"){i=new Citem(f);i.findCitemById();i.changeItemPosition()}},complete:function(){},error:function(){}})}},cursorAt:{top:5,left:5},opacity:0.5,modal:false})})});jQuery("#cw-form-button-add").live("click",function(){var e=jQuery(".cw-item-selected").attr("cid");e=new Citem(e);e.findCitemById();e.saveURL()});jQuery("#cw-form-button-delete").live("click",
function(){jQuery("#cw-search-keyword").val("");jQuery("#cw-show-keyword").val("");jQuery("#cw-switch-url").val(1);jQuery("#cw-switch-custom-url").hide();jQuery("#cw-switch-custom-url").val("");jQuery("#cw-url-ishot").attr("checked",false);jQuery("#cw-url-isnew").attr("checked",false);jQuery("#cw-url-iscolor").attr("checked",false)});jQuery("#cw-switch-url").live("change",function(){if(jQuery("#cw-switch-url").val()=="0")jQuery("#cw-switch-custom-url").show();else{jQuery("#cw-switch-custom-url").val("");
jQuery("#cw-switch-custom-url").hide()}});var b,d,a,c;jQuery("div.cw-add-keyword").live("click",function(){jQuery("ul.ank-categorylist-box","#ank").empty();jQuery(".ank-newkeyword-real").empty();jQuery(this).attr("navtype");d=jQuery(this).attr("pid");c=a="0";switch(d){case "cw-categorylist2":a=jQuery("#cw-categorylist1 .cw-item-icon-selected:visible").parent().attr("cid");break;case "cw-categorylist3":a=jQuery("#cw-categorylist2 .cw-item-icon-selected:visible").parent().attr("cid");break;case "cw-categorylist4":a=
jQuery(this).data("parentId");c="1";break;default:c=a="0";break}if(a==undefined)alert("\u5bf9\u4e0d\u8d77\uff0c\u8bf7\u9009\u62e9\u597d\u76f8\u5e94\u7684\u7236\u7c7b\u76ee");else if(b){b.show();b.moveToY(30)}else b=new Boxy("#ank",{modal:true,title:"<input type='hidden' value='' class='ank-boxid'/><input type='hidden' value='' id='ank-parentid'/>\u6dfb\u52a0\u5173\u952e\u5b57",center:false,afterShow:function(){this.moveToY(30);jQuery(".ank-boxid").val(d);jQuery("#ank-parentid").val(a);(new Keyword).Initial()},afterHide:function(){this.removeOtherNull()}});return false});jQuery("span.delete-url-category").live("click",
function(){jQuery("#cw-category-name").text("");jQuery("#cw-category-fullname").val("");jQuery("#cw-category-nameid").val("")});jQuery("#cw-form-button-preview").live("click",function(){var e=jQuery("#pageId").val();window.open(get_cms_url()+"/page/preview_checked_page.html?page_id="+e+"&template_name=&template_id=0","newwindow","")})};this.Initial=function(){var b="",d="",a=categoryJson;jQuery("#cw-categorylist1").html("");jQuery("#cw-categorylist2").html("");jQuery("#cw-categorylist3").html("");
jQuery("#cw-categorylist4").html("");if(!this.isTrue(a)){this.InitailURL();return false}for(var c=0;c<a.length;c++){a[c].isHotKey=false;a[c].category||(d="cw-hotkey-item");b+='<li class="cw-category-item '+d+'" orderId="'+a[c].orderId+'" cid="'+a[c].id+'">'+a[c].showName+'<span class="cw-item-icon-selected"></span><span class="cw-item-icon-delete"></span></li>';d=""}jQuery("#cw-categorylist1").html(b);b="";a=a[0].treeList;if(this.isTrue(a)){for(c=0;c<a.length;c++){a[c].isHotKey=false;a[c].category||
(d="cw-hotkey-item");b+='<li class="cw-category-item '+d+'" orderId="'+a[c].orderId+'" cid="'+a[c].id+'">'+a[c].showName+'<span class="cw-item-icon-selected"></span><span class="cw-item-icon-delete"></span></li>';d=""}jQuery("#cw-categorylist2").html(b);b="";a=a[0].treeList;if(this.isTrue(a)){for(c=0;c<a.length;c++){a[c].isHotKey=false;a[c].category||(d="cw-hotkey-item");b+='<li class="cw-category-item '+d+'" orderId="'+a[c].orderId+'" cid="'+a[c].id+'">'+a[c].showName+'<span class="cw-item-icon-delete"></span></li>';
d=""}jQuery("#cw-categorylist3").html(b)}}b="";a=categoryJson[0].hotList;if(this.isTrue(a)){for(c=0;c<a.length;c++){a[c].isHotKey=true;a[c].category||(d="cw-hotkey-item");b+='<li class="cw-category-item '+d+'" orderId="'+a[c].orderId+'" cid="'+a[c].id+'">'+a[c].showName+'<span class="cw-item-icon-delete"></span></li>';d=""}jQuery("#cw-categorylist4").html(b)}jQuery("#cw-categorylist1 .cw-category-item").eq(0).addClass("cw-item-selected");jQuery("#cw-categorylist1 .cw-item-icon-selected").eq(0).show();
jQuery("#cw-categorylist2 .cw-item-icon-selected").eq(0).show();this.id=categoryJson[0].id;if(this.id!=null&&this.id!=undefined){this.newitem=categoryJson[0];this.newitem.navigationPath=this.newitem.showName;this.showURL()}else this.InitailURL()};this.findCitemById=function(){for(var b=categoryJson,d=null,a=function(f,i){f=f;for(var j=null,n=1;n<=i.length;n++){var k=i[n-1];f=(k=f?f[k]:null)&&k.treeList?k.treeList:null;if(k&&j)k.parent=j;j=k}return j},c=function(f,i,j){f=f;do{i.push(f.id);j.push(f.showName);
f=f.parent}while(f);i.reverse();j.reverse()},e=function(f,i,j,n,k,o,q){f.fatherindex=j;f.fatherid=n;f.newitem=i;f.newitem.navigationPath=k.join(">>");f.newitem.isHotKey=o;f.newitem.parentId=q},h=function(f,i,j){f=a(f,i);var n;if(f){if(f.id==j.id){var k=[],o=[],q=f.parent?f.parent.id:0;c(f,k,o);e(j,f,i,k,o,false,q);return true}if(f.hotList){n=f.hotList;for(var p=0;p<n.length;p++)if(n[p].id==j.id){k=[];o=[];q=f.id;i=i.concat(p);c(f,k,o);k.push(n[p].id);k.hotHit=true;o.push(n[p].showName);e(j,n[p],i,
k,o,true,q);return true}}}return false},g=0;g<b.length;g++){if(h(b,[g],this))break;var l=0;for(d=b[g].treeList;l<d.length;l++){if(h(b,[g,l],this))break;for(var m=0;m<d[l].treeList.length;m++)if(h(b,[g,l,m],this))break}}};this.findObjectById=function(b,d,a){if(b)for(var c=0;c<b.length;c++){if(b[c].id==d){a&&a.push(c);return b[c]}if(b[c].treeList){var e=this.findObjectById(b[c].treeList,d,a);if(e)return e}}return null};this.addItem=function(b,d,a){var c=[],e=[],h=[];switch(d){case "cw-categorylist1":c=
categoryJson;break;case "cw-categorylist2":e[0]=jQuery("#cw-categorylist1 .cw-item-icon-selected:visible").parent().attr("cid");h=categoryJson;for(var g=0;g<h.length;g++)if(h[g].id==e[0]){c=h[g].treeList;break}break;case "cw-categorylist3":e[0]=jQuery("#cw-categorylist1 .cw-item-icon-selected:visible").parent().attr("cid");e[1]=jQuery("#cw-categorylist2 .cw-item-icon-selected:visible").parent().attr("cid");h=categoryJson;for(g=0;g<h.length;g++)if(h[g].id==e[0]){h=h[g].treeList;break}for(g=0;g<h.length;g++)if(h[g].id==
e[1]){c=h[g].treeList;break}break;case "cw-categorylist4":if(a&&a.length&&a[0].parentId)if(e=this.findObjectById(categoryJson,a[0].parentId))c=e.hotList}for(g=0;g<a.length;g++){c.push(a[g]);this._addItemLi(b||a[g].isCategory,d,a[g].id,a[g].showName,a[g].orderId)}};this._addItemLi=function(b,d,a,c,e){var h="";c=c;if(b=="0")h="cw-hotkey-item";if(d=="cw-categorylist1"||d=="cw-categorylist2")c+='<span class="cw-item-icon-selected" style="display: none; "></span>';jQuery("#"+d).append('<li class="cw-category-item '+
h+'"  orderId="'+e+'"  cid="'+a+'">'+c+'<span class="cw-item-icon-delete" style="display: none; "></span></li>')};this.showChild=function(){var b=this.newitem;if(!this.isTrue(b.isHotKey)){var d=b.navigationPath.split(">>"),a="",c=null;c=null;var e="";if(d.length==1){jQuery("#cw-categorylist2").html("");jQuery("#cw-categorylist3").html("");if(this.isTrue(b.treeList)){c=b.treeList;for(b=0;b<c.length;b++){c[b].category||(e="cw-hotkey-item");a+=b==0?'<li class="cw-category-item '+e+'" orderId="'+c[b].orderId+
'"   cid="'+c[b].id+'">'+c[b].showName+'<span style=\'display:inline;\' class="cw-item-icon-selected"></span><span class="cw-item-icon-delete"></span></li>':'<li class="cw-category-item  '+e+'" orderId="'+c[b].orderId+'"    cid="'+c[b].id+'">'+c[b].showName+'<span class="cw-item-icon-selected"></span><span class="cw-item-icon-delete"></span></li>';e=""}jQuery("#cw-categorylist2").html(a);c=c[0].treeList;a="";if(this.isTrue(c)){for(b=0;b<c.length;b++){c[b].category||(e="cw-hotkey-item");a+='<li class="cw-category-item  '+
e+'"  orderId="'+c[b].orderId+'"   cid="'+c[b].id+'">'+c[b].showName+'<span class="cw-item-icon-delete"></span></li>';e=""}jQuery("#cw-categorylist3").html(a)}}}else if(d.length==2){jQuery("#cw-categorylist3").html("");if(this.isTrue(b.treeList)){c=b.treeList;a="";for(b=0;b<c.length;b++){c[b].category||(e="cw-hotkey-item");a+=b==0?'<li class="cw-category-item  '+e+'"  orderId="'+c[b].orderId+'"   cid="'+c[b].id+'">'+c[b].showName+'<span style="display:inline;" class="cw-item-icon-delete"></span></li>':
'<li class="cw-category-item  '+e+'"  orderId="'+c[b].orderId+'"   cid="'+c[b].id+'">'+c[b].showName+'<span class="cw-item-icon-delete"></span></li>';e=""}jQuery("#cw-categorylist3").html(a)}}}};this.showHotkey=function(){if(!this.newitem.isHotKey&&this.isTrue(this.newitem.hotList)){for(var b=this.newitem.hotList,d="",a="",c=0;c<b.length;c++){b[c].isHotKey=true;b[c].category||(a="cw-hotkey-item");d+='<li class="cw-category-item '+a+'" orderId="'+b[c].orderId+'"   cid="'+b[c].id+'">'+b[c].showName+
'<span class="cw-item-icon-delete"></span></li>';a=""}jQuery("#cw-categorylist4").html(d)}else this.newitem.isHotKey||jQuery("#cw-categorylist4").html("");!this.newitem.isHotKey&&this.newitem.id&&jQuery(".cw-hotkeylist .cw-categorylist-add").data("parentId",this.newitem.id)};this.deleteItem=function(){if(confirm("\u5220\u9664\u540e\u4e0d\u80fd\u6062\u590d\uff0c\u4f60\u786e\u5b9a\u8981\u5220\u9664\u4e48\uff1f")){var b=this,d=jQuery("#elf_url").val();jQuery.ajax({type:"get",url:d+"/tools/delete_nav.do",data:"navId="+b.id,cache:false,beforeSend:function(){},success:function(a){a==
"OK"&&b._deleteCitemById(b.id)},complete:function(){},error:function(){}})}};this.postOrderId=function(){var b={dataCount:0,navId:[],orderId:[]},d=[],a=0;switch(this.fatherindex.length){case 1:d=jQuery("#cw-categorylist1 li");break;case 2:d=this.newitem.isHotKey?jQuery("#cw-categorylist4 li"):jQuery("#cw-categorylist2 li");break;case 3:d=jQuery("#cw-categorylist3 li");break}b.dataCount=d.length;for(a=0;a<d.length;a++){b.navId.push(d.eq(a).attr("cid"));b.orderId.push(a)}return b};this.changeItemPosition=
function(){var b=categoryJson,d=[],a=0,c=0;switch(this.fatherindex.length){case 1:d=jQuery("#cw-categorylist1 li");break;case 2:if(this.newitem.isHotKey){b=categoryJson[this.fatherindex[0]].hotList;d=jQuery("#cw-categorylist4 li")}else{b=categoryJson[this.fatherindex[0]].treeList;d=jQuery("#cw-categorylist2 li")}break;case 3:b=categoryJson[this.fatherindex[0]].treeList[this.fatherindex[1]].treeList;d=jQuery("#cw-categorylist3 li");break}for(a=0;a<d.length;a++){for(c=0;c<b.length;c++)if(b[c].id==d.eq(a).attr("cid"))b[c].orderId=
a;d.eq(a).attr("orderId",a)}this.sortObjByProperty(b,"orderId")};this.sortObjByProperty=function(b,d,a){b.sort(function(c,e){return c[d]-e[d]});a=="desc"&&b.reverse()};this.InitailURL=function(){jQuery("#cw-guid-path").text("");jQuery("#cw-category-nameid").val("");jQuery("#cw-search-keyword").val("");jQuery("#cw-show-keyword").val("");jQuery("#cw-switch-url").val("1");jQuery("#cw-switch-custom-url").hide();jQuery("#cw-switch-custom-url").val("");jQuery("#cw-category-name").text("");jQuery("#cw-category-fullname").val("");
jQuery("#cw-url-ishot").attr("checked",false);jQuery("#cw-url-isnew").attr("checked",false);jQuery("#cw-url-iscolor").attr("checked",false)};this.showURL=function(){var b=this.newitem;jQuery("#cw-guid-path").text(b.navigationPath);jQuery("#cw-category-nameid").val(b.categoryId);jQuery("#cw-search-keyword").val(b.searchKeyword);jQuery("#cw-show-keyword").val(b.showKeyword);jQuery("#cw-switch-url").val(b.defaultUrlId);jQuery("#cw-category-name").text(b.fullCategoryName);jQuery("#cw-category-fullname").val(b.fullCategoryName);
var d=b.props?JSON.parse(b.props):{};jQuery(".cw-urlinfo input.define-param").each(function(){var c=jQuery(this).attr("name");jQuery(this).val(d[c]||"")});b.defaultUrlId!="0"?jQuery("#cw-switch-custom-url").hide():jQuery("#cw-switch-custom-url").show();b.customUrl=="#"?jQuery("#cw-switch-custom-url").val(""):jQuery("#cw-switch-custom-url").val(b.customUrl);var a=false;if(b.colorFlag=="1"||b.colorFlag.toLowerCase()=="y")a=true;jQuery("#cw-url-iscolor").attr("checked",a);a=false;if(b.newFlag=="1"||
b.newFlag.toLowerCase()=="y")a=true;jQuery("#cw-url-isnew").attr("checked",a);a=false;if(b.hotFlag=="1"||b.hotFlag.toLowerCase()=="y")a=true;jQuery("#cw-url-ishot").attr("checked",a)};this.getCategoryNameById=function(){jQuery.ajax({type:"get",url:"http://ALIBABA-54473.hz.ali.com/getcname.php",data:"act=getcname&cid="+this.id,cache:false,dataType:"jsonp",beforeSend:function(){},success:function(b){jQuery("#cw-category-name").text(b.categoryName)},complete:function(){},error:function(){jQuery("#cw-category-name").text("\u8bfb\u53d6\u5931\u8d25")}})};
this.isChanged=function(){var b=false,d=this.newitem,a=[];if(this.isTrue(d.id)){a[0]=jQuery("#cw-category-nameid").val();a[1]=jQuery("#cw-search-keyword").val();a[2]=jQuery("#cw-show-keyword").val();a[3]=jQuery("#cw-switch-url  option:selected").val();a[4]=jQuery("#cw-switch-custom-url").val()||"#";b=(b=(b=(b=d.categoryId!=a[0])?true:d.searchKeyword!=a[1])?true:d.showKeyword!=a[2])?true:d.defaultUrlId.toString()!=a[3];d.customUrl=d.customUrl||"#";b=b?true:d.customUrl!=a[4];a[5]=jQuery("#cw-url-iscolor").attr("checked")==
undefined?"N":"Y";b=b?true:d.colorFlag!=a[5];a[6]=jQuery("#cw-url-isnew").attr("checked")==undefined?"N":"Y";b=b?true:d.newFlag!=a[6];a[7]=jQuery("#cw-url-ishot").attr("checked")==undefined?"N":"Y";b=b?true:d.hotFlag!=a[7];a[8]=jQuery("#cw-category-fullname").val();b=b?true:d.fullCategoryName!=a[8]}return b};this.saveURL=function(){var b=false,d=this.newitem,a=[],c=jQuery("#pageId").val();if(this.isTrue(d.id)){a[0]=jQuery("#cw-category-nameid").val();a[1]=jQuery("#cw-search-keyword").val();a[2]=jQuery("#cw-show-keyword").val();
a[3]=jQuery("#cw-switch-url option:selected").val();a[4]=jQuery("#cw-switch-custom-url").val()||"#";b=(b=(b=(b=d.categoryId!=a[0])?true:d.searchKeyword!=a[1])?true:d.showKeyword!=a[2])?true:d.defaultUrlId.toString()!=a[3];d.customUrl=d.customUrl||"#";b=b?true:d.customUrl!=a[4];a[5]=jQuery("#cw-url-iscolor").attr("checked")==undefined?"N":"Y";b=b?true:d.colorFlag!=a[5];a[6]=jQuery("#cw-url-isnew").attr("checked")==undefined?"N":"Y";b=b?true:d.newFlag!=a[6];a[7]=jQuery("#cw-url-ishot").attr("checked")==
undefined?"N":"Y";b=b?true:d.hotFlag!=a[7];a[8]=jQuery("#cw-category-fullname").val();b=b?true:d.fullCategoryName!=a[8];a[8]=a[8]==undefined?"":a[8];a[0]=a[0]==undefined?"":a[0];var e={},h=d.props?JSON.parse(d.props):{};jQuery(".cw-urlinfo input.define-param").each(function(){var i=jQuery.trim(jQuery(this).val()),j=jQuery(this).attr("name");i&&(e[j]=i);b||(b=e[j]!=h[j])});props=JSON.stringify(e);if(a[2]==""&&a[8]==""){alert("\u5bf9\u4e0d\u8d77\uff0c\u5c55\u793a\u5173\u952e\u5b57\u548c\u7c7b\u76ee\u540d\u79f0\u4e0d\u80fd\u540c\u65f6\u4e3a\u7a7a\uff01");return false}if(b){var g,l="",m="";g=a[8].split(">>");
if(g.length>0)l=g[g.length-1];m=a[2]||l||a[1];var f=jQuery("li[cid='"+d.id+"']");g=f.parent().find("li").not(f[0]);for(l=0;l<g.length;l++)if(g.eq(l).text().trim()==m){alert('\u5bf9\u4e0d\u8d77\uff0c\u5df2\u7ecf\u6709\u76f8\u540c\u7684"'+m+'"\u8bb0\u5f55\u5b58\u5728\u4e86\uff01');return false}c={pageId:c,parentId:d.parentId,navId:d.id,categoryId:a[0],fullCategoryName:encodeURIComponent(a[8]),searchKeyword:encodeURIComponent(a[1]),showKeyword:encodeURIComponent(a[2]),defaultUrlId:a[3],customUrl:a[4],colorFlag:a[5],newFlag:a[6],hotFlag:a[7],navType:d.navType,props:encodeURIComponent(props)};
g=jQuery("#elf_url").val();jQuery.ajax({type:"post",url:g+"/tools/update_nav.do?charset=utf-8",data:c,cache:false,beforeSend:function(){},success:function(i){if(i=="OK"){i=d.showName;d.categoryId=a[0];d.searchKeyword=a[1];d.showName=m;if(a[1]!=""){d.category=false;f.addClass("cw-hotkey-item")}else if(a[8]==""&&a[2]!=""){d.category=false;f.addClass("cw-hotkey-item")}else{d.category=true;f.removeClass("cw-hotkey-item")}var j=f.html();j=j.replace(i,d.showName);f.html(j);d.showKeyword=a[2];d.props=props;
d.defaultUrlId=a[3];d.customUrl=a[4];d.colorFlag=a[5];d.newFlag=a[6];d.hotFlag=a[7];d.fullCategoryName=a[8];jQuery("#isurlchanged").val("true");jQuery(".alert_dialog").text("\u4fdd\u5b58\u6210\u529f\uff01");jQuery(".alert_dialog").fadeIn(500).delay(1E3).fadeOut(500)}else alert(i)},complete:function(){},error:function(){}})}}};this.deleteURL=function(){var b=this.newitem,d=this;jQuery.ajax({type:"get",url:"http://ALIBABA-54473.hz.ali.com/addurl.php",data:"act=deleteurl&cid="+b.id,dataType:"jsonp",cache:false,beforeSend:function(){},
success:function(a){if(a.stauts=="ok"){b.categoryName="0";b.searchKeyword="";a=jQuery("li[cid='"+b.id+"']").html();a=a.replace(b.showKeyword,"\u8bf7\u8f93\u5165\u5173\u952e\u8bcd");jQuery("li[cid='"+b.id+"']").html(a);b.showKeyword="\u8bf7\u8f93\u5165\u5173\u952e\u8bcd";b.defaultUrlId="0";b.customUrl="";b.colorFlag="0";b.newFlag="0";b.hotFlag="0";d.showURL()}},complete:function(){},error:function(){}})};this.showSelected=function(){jQuery(".cw-category-item").removeClass("cw-item-selected");jQuery("li[cid='"+this.id+"']").addClass("cw-item-selected")};this.chooseItem=
function(){jQuery("#cw-categorylist1").html("");jQuery("#cw-categorylist2").html("");jQuery("#cw-categorylist3").html("");jQuery("#cw-categorylist4").html("");var b="",d=categoryJson,a="";switch(this.fatherid.length){case 1:for(var c=0;c<d.length;c++){d[c].isHotKey=false;d[c].category||(a="cw-hotkey-item");b+='<li class="cw-category-item '+a+'" orderId="'+d[c].orderId+'" cid="'+d[c].id+'">'+d[c].showName+'<span class="cw-item-icon-selected"></span><span class="cw-item-icon-delete"></span></li>';a=
""}jQuery("#cw-categorylist1").html(b);break;case 2:for(c=0;c<d.length;c++){d[c].isHotKey=false;d[c].category||(a="cw-hotkey-item");b+='<li class="cw-category-item '+a+'" orderId="'+d[c].orderId+'" cid="'+d[c].id+'">'+d[c].showName+'<span class="cw-item-icon-selected"></span><span class="cw-item-icon-delete"></span></li>';a=""}jQuery("#cw-categorylist1").html(b);if(this.newitem.isHotKey){b="";d=categoryJson[this.fatherindex[0]].hotList;if(this.isTrue(d)){for(c=0;c<d.length;c++){d[c].isHotKey=true;
d[c].category||(a="cw-hotkey-item");b+='<li class="cw-category-item '+a+'" orderId="'+d[c].orderId+'" cid="'+d[c].id+'">'+d[c].showName+'<span class="cw-item-icon-delete"></span></li>';a=""}jQuery("#cw-categorylist4").html(b)}}else{b="";d=categoryJson[this.fatherindex[0]].treeList;if(this.isTrue(d)){for(c=0;c<d.length;c++){d[c].isHotKey=true;d[c].category||(a="cw-hotkey-item");b+='<li class="cw-category-item '+a+'" orderId="'+d[c].orderId+'" cid="'+d[c].id+'">'+d[c].showName+'<span class="cw-item-icon-selected"></span><span class="cw-item-icon-delete"></span></li>';
a=""}jQuery("#cw-categorylist2").html(b)}}break;case 3:for(c=0;c<d.length;c++){d[c].isHotKey=false;d[c].category||(a="cw-hotkey-item");b+='<li class="cw-category-item '+a+'" orderId="'+d[c].orderId+'" cid="'+d[c].id+'">'+d[c].showName+'<span class="cw-item-icon-selected"></span><span class="cw-item-icon-delete"></span></li>';a=""}jQuery("#cw-categorylist1").html(b);b="";d=categoryJson[this.fatherindex[0]].treeList;if(this.isTrue(d)){for(c=0;c<d.length;c++){d[c].isHotKey=true;d[c].category||(a="cw-hotkey-item");
b+='<li class="cw-category-item '+a+'" orderId="'+d[c].orderId+'" cid="'+d[c].id+'">'+d[c].showName+'<span class="cw-item-icon-selected"></span><span class="cw-item-icon-delete"></span></li>';a=""}jQuery("#cw-categorylist2").html(b)}b="";d=categoryJson[this.fatherindex[0]].treeList[this.fatherindex[1]].treeList;if(this.isTrue(d)){for(c=0;c<d.length;c++){d[c].isHotKey=true;d[c].category||(a="cw-hotkey-item");b+='<li class="cw-category-item '+a+'" orderId="'+d[c].orderId+'" cid="'+d[c].id+'">'+d[c].showName+
'<span class="cw-item-icon-delete"></span></li>';a=""}jQuery("#cw-categorylist3").html(b)}break}this.showSelectButton();this.showSelected();this.showChild();this.showURL();this.showHotkey()};this.showSelectButton=function(){if(jQuery("#cw-categorylist4 > li[cid='"+this.id+"']").size()>0)jQuery("li[cid='"+this.fatherid[0]+"'] .cw-item-icon-selected").show();else{jQuery(".cw-item-icon-selected").hide();for(var b=0;b<this.fatherid.length;b++)jQuery("li[cid="+this.fatherid[b]+"] .cw-item-icon-selected").show()}};
this.showDeleteButton=function(){jQuery("span.cw-item-icon-delete").hide();jQuery("li[cid='"+this.id+"'] .cw-item-icon-delete").show()};this.hideDeleteButton=function(){Query("li[cid='"+this.id+"'] .cw-item-icon-delete").hide(2E3)};this._deleteChildLiById=function(b){jQuery("li[cid='"+b+"']").remove()};this._deleteCitemById=function(b){var d=[].concat(this.fatherindex),a=[].concat(this.fatherid);if(this.fatherid.hotHit){a.pop();var c=a.pop();(a=this.findObjectById(categoryJson,c))&&a.hotList&&a.hotList.splice(d.pop(),
1)}else{a=["#cw-categorylist2","#cw-categorylist3","#cw-categorylist4"];if(jQuery("li[cid='"+b+"'] .cw-item-icon-selected").css("display")!="none")for(c=d.length-1;c<a.length;c++)jQuery(a[c]).html("");var e=categoryJson;a=e;var h=d.length;if(h>1)for(;c<h-1;c++)e=(a=e)?a[d[c]].treeList:null;a&&a.splice(d.pop(),1)}this._deleteChildLiById(b)};this.isTrue=function(b){if(b==false||b==null||b==undefined||b==""||typeof b==undefined||b.toString()=="")return false;else if(typeof b=="object"){for(var d in b)return true;
return false}else return true}};
