var Choose_Category=function(){this.InitialHtml=function(htmlid){var thehtml='<div class="cc" id="cc" >                            \t<div class="cc-row">\t                        \t\t<label for="keywords">\u8f93\u5165\u7c7b\u76ee\u540d\uff1a</label><input type="hidden" id="ajaxqueen" value="" />\t                        \t\t<input type="text" class="" id="keyword" name="keyword"/>                                \t<input type="submit" class="form-button"  id="cc-form-button-search" value="\u641c\u7d22"/>                            \t</div>                            \t<div class="cc-row">\t\t\t\t\t\t\t\t\t<ul class="cc-result-box" id="cc-result-box"></ul>                            \t</div>                            \t<div class="cc-row">\t\t\t\t\t\t\t\t\t<ul class="cc-categorybox-list">\t\t\t\t\t\t\t\t\t\t<li>                            \t\t\t\t<button class="cc-leftList-button"><</button>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t\t<li>\t\t\t\t\t\t\t\t\t\t\t<dl>\t\t\t\t\t\t\t\t\t\t\t\t<dt>\u4e00\u7ea7\u7c7b\u76ee\uff1a</dt>\t\t\t\t\t\t\t\t\t\t\t\t<dd><ul class="cc-categorylist-box" id="cc-grade1-list"></ul></dd>\t\t\t\t\t\t\t\t\t\t\t</dl>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t\t<li>\t\t\t\t\t\t\t\t\t\t\t<dl>\t\t\t\t\t\t\t\t\t\t\t\t<dt>\u4e8c\u7ea7\u7c7b\u76ee\uff1a</dt>\t\t\t\t\t\t\t\t\t\t\t\t<dd><ul class="cc-categorylist-box" id="cc-grade2-list"></ul></dd>\t\t\t\t\t\t\t\t\t\t\t</dl>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t\t<li>\t\t\t\t\t\t\t\t\t\t\t<dl>\t\t\t\t\t\t\t\t\t\t\t\t<dt>\u4e09\u7ea7\u7c7b\u76ee\uff1a</dt>\t\t\t\t\t\t\t\t\t\t\t\t<dd><ul class="cc-categorylist-box" id="cc-grade3-list"></ul></dd>\t\t\t\t\t\t\t\t\t\t\t</dl>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t\t<li style="display:none">\t\t\t\t\t\t\t\t\t\t\t<dl>\t\t\t\t\t\t\t\t\t\t\t\t<dt>\u56db\u7ea7\u7c7b\u76ee\uff1a</dt>\t\t\t\t\t\t\t\t\t\t\t\t<dd><ul class="cc-categorylist-box" id="cc-grade4-list"></ul></dd>\t\t\t\t\t\t\t\t\t\t\t</dl>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t\t<li style="display:none">\t\t\t\t\t\t\t\t\t\t\t<dl>\t\t\t\t\t\t\t\t\t\t\t\t<dt>\u4e94\u7ea7\u7c7b\u76ee\uff1a</dt>\t\t\t\t\t\t\t\t\t\t\t\t<dd><ul class="cc-categorylist-box" id="cc-grade5-list"></ul></dd>\t\t\t\t\t\t\t\t\t\t\t</dl>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t\t<li>                            \t\t\t\t<button class="cc-rightList-button">></button>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t</ul>                            \t</div>                            \t<div class="cc-row">                                \t<button class="form-button"  id="cc-form-button-choose" >\u786e\u5b9a</button>                                \t<button class="form-button"  id="cc-form-button-close" >\u5173\u95ed</button>                            \t</div>                           </div>';
if(htmlid!=undefined&&jQuery(htmlid)!=undefined)jQuery(htmlid).append(thehtml);else jQuery("body").append(thehtml)};this.getCategory=function(searchParam,callbackFunc,grade){if(searchParam==-1)reqUrl=get_elf_url()+"/tools/get_child_by_category.do";else if(searchParam.indexOf("keyword")!=-1)reqUrl=get_elf_url()+"/tools/get_category_by_keyword.do?"+searchParam;else if(searchParam.indexOf("categoryId")!=-1)reqUrl=get_elf_url()+"/tools/get_child_by_category.do?"+searchParam;else return;jQuery.ajax({type:"get",
url:reqUrl,dataType:"jsonp",success:function(data,textStatus){result=data;callbackFunc(data,grade)},error:function(){alert("\u83b7\u53d6\u7c7b\u76ee\u5931\u8d25\uff01")}});return};this.dealSearchResult=function(data,grade){var myjson=data.categoryList;var categoryList="";for(var i=0;i<myjson.length;i++)categoryList+="<li><input type='radio' name='category' fullName='"+myjson[i].fullName+"'  id=\""+myjson[i].id+'" >'+myjson[i].fullName+" </li>";jQuery("ul.cc-result-box").html(categoryList)};this.dealCateResult=
function(data,grade){var myjson=data.categoryList;var categoryList="";for(var i=0;i<myjson.length;i++){categoryList+='<li><input type=radio name="category" fullName="'+myjson[i].fullName+'" id="'+myjson[i].id+'">'+myjson[i].categoryName;if(myjson[i].leaf==false)categoryList+=" >> ";categoryList+="</li>"}jQuery("#cc-grade"+grade+"-list").html(categoryList);jQuery("#cc-grade"+(grade+1)+"-list").html("");jQuery(".cc-rightList-button").hide();if(grade==4&&categoryList!=""){jQuery(".cc-categorybox-list").children().eq(1).hide();
jQuery(".cc-categorybox-list").children().eq(4).show();jQuery(".cc-leftList-button").show()}if(grade==5&&categoryList!=""){jQuery(".cc-categorybox-list").children().eq(2).hide();jQuery(".cc-categorybox-list").children().eq(5).show()}var thefullname=jQuery(".ac-category-Name").val();if(thefullname!=undefined&&thefullname!=""){var nowcategorynamearray=[];var thegradelist=jQuery("#cc-grade"+grade+"-list");var isclicked=thegradelist.attr("isclicked");nowcategorynamearray=thefullname.split(">>");if(isclicked!=
"Y"&&nowcategorynamearray.length>grade-1){var thefirstname=nowcategorynamearray[grade-1].trim();var thefirstnamemore=thefirstname+">>";var thelis=thegradelist.find("li");var thetext="";for(var i=0;i<thelis.length;i++){thetext=thelis.eq(i).text().replace(/\s*/g,"");if(thetext==thefirstname||thetext==thefirstnamemore){thelis.eq(i).click();thegradelist.attr("isclicked","Y");return}}}}};this.chooseItem=function(item){jQuery(item).find("input").attr("checked",true);jQuery(".cc-item-active").removeClass("cc-item-selected");
jQuery(item).siblings().andSelf().removeClass("cc-item-active");jQuery(item).addClass("cc-item-active");jQuery(item).addClass("cc-item-selected")};this.BindEvent=function(){var self=this;var cc_dialog,thebutton;jQuery(".choose-category").live("click",function(){thebutton=jQuery(this);jQuery("input").removeClass("ac-category-Id").removeClass("ac-category-Name");jQuery("span.ac-category-Name-span").removeClass("ac-category-Name-span");thebutton.parent().find("input[name=ank-categoryId]").addClass("ac-category-Id");
thebutton.parent().find("input[name=ank-categoryName]").addClass("ac-category-Name");thebutton.parent().find("span[class=ank-categoryName]").addClass("ac-category-Name-span");if(cc_dialog)cc_dialog.show();else cc_dialog=new Boxy("#cc",{modal:true,title:"\u9009\u53d6\u7c7b\u76ee",afterHide:function(){jQuery("ul.cc-categorylist-box").html("");jQuery("ul.cc-result-box").html("");jQuery("#keyword").val("");this.removeOtherNull()},afterShow:function(){jQuery(".cc-categorylist-box").attr("isclicked","");
jQuery(".cc-leftList-button").click();self.getCategory(-1,self.dealCateResult,1)}});return false});jQuery("ul.cc-result-box li").live("click",function(){self.chooseItem(this)});jQuery("#cc-grade1-list li").live("click",function(){self.chooseItem(this);var categoryId=jQuery(this).find("input").attr("id");self.getCategory("categoryId="+categoryId,self.dealCateResult,2)});jQuery("#cc-grade2-list li").live("click",function(){self.chooseItem(this);var categoryId=jQuery(this).find("input").attr("id");self.getCategory("categoryId="+
categoryId,self.dealCateResult,3)});jQuery("#cc-grade3-list li").live("click",function(){var categoryId=jQuery(this).find("input").attr("id");self.chooseItem(this);self.getCategory("categoryId="+categoryId,self.dealCateResult,4)});jQuery("#cc-grade4-list li").live("click",function(){var categoryId=jQuery(this).find("input").attr("id");self.chooseItem(this);self.getCategory("categoryId="+categoryId,self.dealCateResult,5)});jQuery("#cc-grade5-list li").live("click",function(){self.chooseItem(this)});
jQuery("#cc-form-button-choose").live("click",function(){var selected_item=jQuery(".cc :checked");var selected_category=selected_item.attr("fullName");var selected_caid=selected_item.attr("id");jQuery(".ac-category-Id").val(selected_caid);jQuery(".ac-category-Name").val(selected_category);jQuery(".ac-category-Name-span").text(selected_category);if(jQuery("#bmc-url"))jQuery("#bmc-url").change();cc_dialog.hide()});jQuery("#cc-form-button-close").click(function(){cc_dialog.hide()});jQuery("#cc-form-button-search").click(function(){var keyword=
jQuery("#keyword").attr("value");if(keyword==""||keyword==null){alert("\u8bf7\u8f93\u5165\u5173\u952e\u5b57");return}self.getCategory("keyword="+keyword,self.dealSearchResult,0)});jQuery(".cc-leftList-button").click(function(){jQuery(".cc-categorybox-list").children().eq(1).show();jQuery(".cc-categorybox-list").children().eq(2).show();jQuery(".cc-categorybox-list").children().eq(4).hide();jQuery(".cc-categorybox-list").children().eq(5).hide();jQuery(this).hide();jQuery(".cc-rightList-button").show()});
jQuery(".cc-rightList-button").click(function(){jQuery(".cc-categorybox-list").children().eq(1).hide();jQuery(".cc-categorybox-list").children().eq(2).hide();jQuery(".cc-categorybox-list").children().eq(4).show();jQuery(".cc-categorybox-list").children().eq(5).show();jQuery(this).hide();jQuery(".cc-leftList-button").show()})}};
