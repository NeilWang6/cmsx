var Manage_Junk_Category=function(){this.InitialHtml=function(htmlid){var thehtml='<div class="bmc" id="bmc" >\t\t\t\t\t\t    <input type="hidden" name="bmc-submitURL" id="bmc-submitURL">\t\t\t\t\t\t\t<div class="bmc-row">\t\t\t\t\t\t\t\t<label for="url">URL\u89c4\u5219\uff1a</label>\t\t\t\t\t\t\t\t<input type=text name="url" readonly="true" id="bmc-url" >\t\t\t\t\t    \t</div>\t\t\t\t\t    \t<div class="bmc-row">\t\t\t\t\t\t\t\t<label for="cateName">\u7c7b\u76ee\u540d\uff1a</label>\t\t\t\t\t\t\t\t<input type=text readonly="true" id="bmc-cateName" name="ank-categoryName">\t\t\t\t\t\t\t\t<input type=hidden  id="bmc-categoryId" name="ank-categoryId"/>\t\t\t\t\t\t\t\t<input type=hidden name="pageid" id="bmc-pageid"/>\t\t\t\t\t\t\t\t<input type=hidden name="ids" id="bmc-ids"/>\t\t\t\t\t\t\t\t<span class="choose-category">\u66f4\u6539</span>\t\t\t\t\t    \t</div>\t\t\t\t\t    \t<div class="bmc-row">\t\t\t\t\t    \t\t<label for="searchKeywords">\u641c\u7d22\u5173\u952e\u5b57\uff1a</label>\t\t\t\t\t    \t\t<input type="text" id="bmc-searchKeyword" name="searchKeyword"/>\t\t\t\t\t    \t</div>\t\t\t\t\t    \t<div class="bmc-row">\t\t\t\t\t    \t\t<label for="showKeywords">\u5c55\u793a\u5173\u952e\u5b57\uff1a</label>\t\t\t\t\t    \t\t<input type="text" id="bmc-showKeyword" name="showKeyword"/>\t\t\t\t\t    \t</div>\t\t\t\t\t    \t<div class="bmc-row nm-text-center">\t\t\t\t\t        \t<input type="button" class="form-button"  id="bmc-form-button-bp" value="\u4fdd\u5b58\u5e76\u9884\u89c8"/>\t\t\t\t\t        \t<input type="button" class="form-button"  id="bmc-form-button-close" value="\u5173\u95ed"/>\t\t\t\t\t    \t</div>\t\t\t\t\t   </div>\t\t            \t<div class="bp" id="bp" >\t\t\t\t\t\t\t<table class="bp-table" cellspacing="0">\t\t\t\t\t\t\t\t<thead>\t\t\t\t\t\t\t\t\t<tr>\t\t\t\t\t\t\t\t\t\t<th>PageId</th>\t\t\t\t\t\t\t\t\t\t<th>\u9875\u9762\u540d\u79f0</th>\t\t\t\t\t\t\t\t\t\t<th>\u9884\u89c8</th>\t\t\t\t\t\t\t\t\t</tr>\t\t\t\t\t\t\t\t</thead>\t\t\t\t\t\t\t\t<tbody>\t\t\t\t\t\t\t\t</tbody>\t\t\t\t\t\t\t</table>\t\t\t\t\t\t</div>';
if(htmlid!=undefined&&jQuery(htmlid)!=undefined)jQuery(htmlid).append(thehtml);else jQuery("body").append(thehtml)};this.generateUrl=function(){var url="";if(jQuery("#bmc-categoryId").val()!=null&&jQuery("#bmc-categoryId").val()!="")url+="c-"+jQuery("#bmc-categoryId").val()+"&";if(jQuery("#bmc-searchKeyword").val()!=null&&jQuery("#bmc-searchKeyword").val()!="")url+="k-"+jQuery("#bmc-searchKeyword").val()+"&";url=url.substring(0,url.length-1);jQuery("#bmc-url").val(url)};this.BindEvent=function(){var self=
this;var bmc_dialog,bp_dialog,cc_dialog;jQuery(".mjc-table tr:odd").addClass("odd");jQuery(".mjc-table tr").bind("click",function(){jQuery(this).find("input[type=checkbox]").attr("checked",jQuery(this).find("input[type=checkbox]").attr("checked")=="checked"?false:true)});jQuery(":checkbox").bind("click",function(event){event.stopPropagation()});jQuery("#mjc-form-button-bmc").click(function(){if(jQuery(".mjc-table :checked").length==0){alert("\u60a8\u8fd8\u6ca1\u9009\u62e9\u7c7b\u76ee");return}var ids=
jQuery(".mjc-table :checked:first").parent().find("input[name='ids']").val();var pageid=jQuery(".mjc-table :checked:first").parent().find("input[name='ids']").val();var categoryId=jQuery(".mjc-table :checked:first").parent().find("input[name='categoryId']").val();var previewURL=jQuery(".mjc-table :checked:first").parent().find("input[name='previewURL']").val();var cateFullName=jQuery(".mjc-table :checked:first").parent().find("input[name='fullCategoryName']").val();var cateName=jQuery(".mjc-table :checked:first").parent().parent().find("td[name='cateName']").text();
var searchKeyword=jQuery(".mjc-table :checked:first").parent().parent().find("td[name='searchKeyword']").text();var showKeyword=jQuery(".mjc-table :checked:first").parent().parent().find("td[name='showKeyword']").text();var url=jQuery(".mjc-table :checked:first").parent().parent().find("td[name='url']").text();var flag=true;jQuery(".mjc-table :checked:gt(0)").each(function(){if(jQuery(this).parent().find("input[name='categoryId']").val()!=categoryId){alert("\u7c7b\u76eeID\u4e0d\u540c\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9");
flag=false;return false}if(jQuery(this).parent().parent().find("td[name='searchKeyword']").text()!=searchKeyword){alert("\u641c\u7d22\u5173\u952e\u5b57\u4e0d\u540c\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9");flag=false;return false}if(jQuery(this).parent().parent().find("td[name='showKeyword']").text()!=showKeyword){alert("\u5c55\u793a\u5173\u952e\u5b57\u4e0d\u540c\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9");flag=false;return false}ids+=","+jQuery(this).parent().find("input[name='ids']").val()});if(flag){jQuery("#bmc-url").attr("value",
url);jQuery("#bmc-cateName").attr("value",cateFullName);jQuery("#bmc-searchKeyword").attr("value",searchKeyword);jQuery("#bmc-showKeyword").attr("value",showKeyword);jQuery("#bmc-categoryId").attr("value",categoryId);jQuery("#bmc-pageid").attr("value",pageid);jQuery("#bmc-ids").attr("value",ids);if(bmc_dialog)bmc_dialog.show();else bmc_dialog=new Boxy("#bmc",{title:"\u6279\u91cf\u4fee\u6539URL\u89c4\u5219",beforeUnload:function(){},unloadOnHide:false})}else return});jQuery("#bmc-url").change(function(){self.generateUrl()});
jQuery("#bmc-form-button-bp").click(function(){jQuery.ajax({type:"post",url:jQuery("#bmc-submitURL").val(),contentType:"application/x-www-form-urlencoded; charset=utf-8",dataType:"json",data:{"url":encodeURIComponent(jQuery("#bmc-url").val()),"categoryId":jQuery("#bmc-categoryId").val(),"searchKeyword":encodeURIComponent(jQuery("#bmc-searchKeyword").val()),"showKeyword":encodeURIComponent(jQuery("#bmc-showKeyword").val()),"ids":jQuery("#bmc-ids").val(),"charset":"UTF-8"},cache:false,success:function(data,
textStatus){if(data.result=="Ok"){alert("\u6dfb\u52a0\u6210\u529f\uff01");bmc_dialog.hide();if(bp_dialog)bp_dialog.show();else bp_dialog=new Boxy("#bp",{title:"\u6279\u91cf\u9884\u89c8",afterHide:function(){jQuery("#keywordQueryManagerForm").submit()},afterShow:function(){var checkedList="";jQuery(".mjc-table :checked").each(function(){checkedList+="<tr><td>"+jQuery(this).parent().find("input[name='pageid']").val()+"</td>"+"<td>"+jQuery(this).parent().parent().find("td[name='pageName']").text()+"</td>"+
"<td><a target='_blank' href=\""+jQuery(this).parent().find("input[name='previewURL']").val()+'">\u9884\u89c8</a></td></tr>'});jQuery(".bp-table").find("tbody").html(checkedList)},unloadOnHide:false})}else alert(data.result)},error:function(){alert("\u6dfb\u52a0\u5931\u8d25")}})});jQuery("#bmc-form-button-close").click(function(){bmc_dialog.hide()});jQuery("#bmc-searchKeyword").keyup(function(){self.generateUrl()});jQuery("#bmc-categoryId").bind("propertychange",function(){self.generateUrl()})}};
