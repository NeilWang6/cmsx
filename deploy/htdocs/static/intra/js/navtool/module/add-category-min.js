var Add_Category=function(){this.InitialHtml=function(a){a!=undefined&&jQuery(a)!=undefined?jQuery(a).append('<div class="ac" id="ac" >                            \t<div class="ac-row">\t                        \t\t<label for="keywords">\u8f93\u5165\u7c7b\u76ee\u540d\uff1a</label>\t                        \t\t<input type="text" class="" id="ac-keyword" name="ac-keyword"/>                                \t<input type="submit" class="form-button"  id="ac-form-button-search" value="\u641c\u7d22"/>                            \t</div>                            \t<div class="ac-row">\t\t\t\t\t\t\t\t\t<ul class="ac-result-box"></ul>                                </div>                            \t<div class="ac-row">\t\t\t\t\t\t\t\t\t<ul class="ac-categorybox-list">\t\t\t\t\t\t\t\t\t\t<li>                            \t\t\t\t<button class="ac-leftList-button"><</button>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t\t<li>\t\t\t\t\t\t\t\t\t\t\t<dl>\t\t\t\t\t\t\t\t\t\t\t\t<dt>\u4e00\u7ea7\u7c7b\u76ee\uff1a</dt>\t\t\t\t\t\t\t\t\t\t\t\t<dd><ul class="ac-categorylist-box" id="ac-grade1-list"></ul></dd>\t\t\t\t\t\t\t\t\t\t\t</dl>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t\t<li>\t\t\t\t\t\t\t\t\t\t\t<dl>\t\t\t\t\t\t\t\t\t\t\t\t<dt>\u4e8c\u7ea7\u7c7b\u76ee\uff1a</dt>\t\t\t\t\t\t\t\t\t\t\t\t<dd><ul class="ac-categorylist-box" id="ac-grade2-list"></ul></dd>\t\t\t\t\t\t\t\t\t\t\t</dl>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t\t<li>\t\t\t\t\t\t\t\t\t\t\t<dl>\t\t\t\t\t\t\t\t\t\t\t\t<dt>\u4e09\u7ea7\u7c7b\u76ee\uff1a</dt>\t\t\t\t\t\t\t\t\t\t\t\t<dd><ul class="ac-categorylist-box" id="ac-grade3-list"></ul></dd>\t\t\t\t\t\t\t\t\t\t\t</dl>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t\t<li style="display:none">\t\t\t\t\t\t\t\t\t\t\t<dl>\t\t\t\t\t\t\t\t\t\t\t\t<dt>\u56db\u7ea7\u7c7b\u76ee\uff1a</dt>\t\t\t\t\t\t\t\t\t\t\t\t<dd><ul class="ac-categorylist-box" id="ac-grade4-list"></ul></dd>\t\t\t\t\t\t\t\t\t\t\t</dl>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t\t<li style="display:none">\t\t\t\t\t\t\t\t\t\t\t<dl>\t\t\t\t\t\t\t\t\t\t\t\t<dt>\u4e94\u7ea7\u7c7b\u76ee\uff1a</dt>\t\t\t\t\t\t\t\t\t\t\t\t<dd><ul class="ac-categorylist-box" id="ac-grade5-list"></ul></dd>\t\t\t\t\t\t\t\t\t\t\t</dl>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t\t<li>                            \t\t\t\t<button class="ac-rightList-button">></button>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t</ul>                                </div>                            \t<div class="ac-row">\t\t\t\t\t\t\t\t\t<input type="hidden" name="ac-pageid" id="ac-pageid"/>\t\t\t\t\t\t\t\t\t<input type="hidden" name="ac-parentid" id="ac-parentid"/>\t\t\t\t\t\t\t\t\t<input type="hidden" name="ac-boxid" id="ac-boxid"/>\t\t\t\t\t\t\t\t\t\t\t<dl>\t\t\t\t\t\t\t\t\t\t\t\t<dt>\u5df2\u7ecf\u9009\u62e9\u7684\u7c7b\u76ee:</dt>\t\t\t\t\t\t\t\t\t\t\t\t<dd><ul class="ac-selected-box"></ul></dd>\t\t\t\t\t\t\t\t\t\t\t</dl>                            \t<div class="ac-row">\t                                <input type="radio" value="1" checked="checked"  name="urlRule"/><label for="">\u8bbe\u7f6e\u5927\u5e02\u573aURL\u89c4\u5219</label>\t                                <input type="radio" value="2" name="urlRule"/><label for="">\u8bbe\u7f6e\u5de5\u4e1a\u54c1URL\u89c4\u5219</label>\t\t\t\t\t\t\t\t\t<input type="radio" value="3" name="urlRule"/><label for="">\u8bbe\u7f6e\u539f\u6750\u6599URL\u89c4\u5219</label>\t                                <input type="radio" value="0"  name="urlRule"/><label for="">\u4e0d\u8bbe\u7f6e\u9ed8\u8ba4\u503c</label>                                </div>                            \t<div class="ac-row">                                \t<input type="button" class="form-button"  id="ac-form-button-add" value="\u6dfb\u52a0"/>                                \t<input type="button" class="form-button"  id="ac-form-button-close" value="\u5173\u95ed"/>                            \t</div>\t\t\t\t\t\t\t\t</form>\t\t\t\t\t</div>\t'):
jQuery("body").append('<div class="ac" id="ac" >                            \t<div class="ac-row">\t                        \t\t<label for="keywords">\u8f93\u5165\u7c7b\u76ee\u540d\uff1a</label>\t                        \t\t<input type="text" class="" id="ac-keyword" name="ac-keyword"/>                                \t<input type="submit" class="form-button"  id="ac-form-button-search" value="\u641c\u7d22"/>                            \t</div>                            \t<div class="ac-row">\t\t\t\t\t\t\t\t\t<ul class="ac-result-box"></ul>                                </div>                            \t<div class="ac-row">\t\t\t\t\t\t\t\t\t<ul class="ac-categorybox-list">\t\t\t\t\t\t\t\t\t\t<li>                            \t\t\t\t<button class="ac-leftList-button"><</button>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t\t<li>\t\t\t\t\t\t\t\t\t\t\t<dl>\t\t\t\t\t\t\t\t\t\t\t\t<dt>\u4e00\u7ea7\u7c7b\u76ee\uff1a</dt>\t\t\t\t\t\t\t\t\t\t\t\t<dd><ul class="ac-categorylist-box" id="ac-grade1-list"></ul></dd>\t\t\t\t\t\t\t\t\t\t\t</dl>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t\t<li>\t\t\t\t\t\t\t\t\t\t\t<dl>\t\t\t\t\t\t\t\t\t\t\t\t<dt>\u4e8c\u7ea7\u7c7b\u76ee\uff1a</dt>\t\t\t\t\t\t\t\t\t\t\t\t<dd><ul class="ac-categorylist-box" id="ac-grade2-list"></ul></dd>\t\t\t\t\t\t\t\t\t\t\t</dl>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t\t<li>\t\t\t\t\t\t\t\t\t\t\t<dl>\t\t\t\t\t\t\t\t\t\t\t\t<dt>\u4e09\u7ea7\u7c7b\u76ee\uff1a</dt>\t\t\t\t\t\t\t\t\t\t\t\t<dd><ul class="ac-categorylist-box" id="ac-grade3-list"></ul></dd>\t\t\t\t\t\t\t\t\t\t\t</dl>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t\t<li style="display:none">\t\t\t\t\t\t\t\t\t\t\t<dl>\t\t\t\t\t\t\t\t\t\t\t\t<dt>\u56db\u7ea7\u7c7b\u76ee\uff1a</dt>\t\t\t\t\t\t\t\t\t\t\t\t<dd><ul class="ac-categorylist-box" id="ac-grade4-list"></ul></dd>\t\t\t\t\t\t\t\t\t\t\t</dl>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t\t<li style="display:none">\t\t\t\t\t\t\t\t\t\t\t<dl>\t\t\t\t\t\t\t\t\t\t\t\t<dt>\u4e94\u7ea7\u7c7b\u76ee\uff1a</dt>\t\t\t\t\t\t\t\t\t\t\t\t<dd><ul class="ac-categorylist-box" id="ac-grade5-list"></ul></dd>\t\t\t\t\t\t\t\t\t\t\t</dl>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t\t<li>                            \t\t\t\t<button class="ac-rightList-button">></button>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t</ul>                                </div>                            \t<div class="ac-row">\t\t\t\t\t\t\t\t\t<input type="hidden" name="ac-pageid" id="ac-pageid"/>\t\t\t\t\t\t\t\t\t<input type="hidden" name="ac-parentid" id="ac-parentid"/>\t\t\t\t\t\t\t\t\t<input type="hidden" name="ac-boxid" id="ac-boxid"/>\t\t\t\t\t\t\t\t\t\t\t<dl>\t\t\t\t\t\t\t\t\t\t\t\t<dt>\u5df2\u7ecf\u9009\u62e9\u7684\u7c7b\u76ee:</dt>\t\t\t\t\t\t\t\t\t\t\t\t<dd><ul class="ac-selected-box"></ul></dd>\t\t\t\t\t\t\t\t\t\t\t</dl>                            \t<div class="ac-row">\t                                <input type="radio" value="1" checked="checked"  name="urlRule"/><label for="">\u8bbe\u7f6e\u5927\u5e02\u573aURL\u89c4\u5219</label>\t                                <input type="radio" value="2" name="urlRule"/><label for="">\u8bbe\u7f6e\u5de5\u4e1a\u54c1URL\u89c4\u5219</label>\t\t\t\t\t\t\t\t\t<input type="radio" value="3" name="urlRule"/><label for="">\u8bbe\u7f6e\u539f\u6750\u6599URL\u89c4\u5219</label>\t                                <input type="radio" value="0"  name="urlRule"/><label for="">\u4e0d\u8bbe\u7f6e\u9ed8\u8ba4\u503c</label>                                </div>                            \t<div class="ac-row">                                \t<input type="button" class="form-button"  id="ac-form-button-add" value="\u6dfb\u52a0"/>                                \t<input type="button" class="form-button"  id="ac-form-button-close" value="\u5173\u95ed"/>                            \t</div>\t\t\t\t\t\t\t\t</form>\t\t\t\t\t</div>\t')};
this.getCategory=function(a,e,b){if(a==-1)reqUrl=get_elf_url()+"/tools/get_child_by_category.do";else if(a.indexOf("keyword")!=-1)reqUrl=get_elf_url()+"/tools/get_category_by_keyword.do?"+a;else if(a.indexOf("categoryId")!=-1)reqUrl=get_elf_url()+"/tools/get_child_by_category.do?"+a;else return;jQuery.ajax({type:"get",url:reqUrl,dataType:"jsonp",success:function(c){result=c;e(c,b)},error:function(){alert("\u83b7\u53d6\u7c7b\u76ee\u5931\u8d25\uff01")}})};this.addSelectedItem=function(a,e){for(var b=true,c=jQuery("ul.ac-selected-box span.ac-category-full-name"),
g=0,h=c.length;g<h;g++)if(c.eq(g).text()==e)b=false;if(b){b="";b+="<li name='"+a+"'>";b+="<span class='ac-category-full-name'>"+e+"</span>";b+="<span class='ac-delete-button'></span></li>";jQuery("ul.ac-selected-box").prepend(b)}};this.dealSearchResult=function(a){a=a.categoryList;for(var e="",b=0;b<a.length;b++)e+="<li><input type='checkbox' name='"+a[b].id+"' fullName='"+a[b].fullName+"'>"+a[b].fullName+" </li>";jQuery("ul.ac-result-box").html(e);jQuery("ul.ac-selected-box li").each(function(){jQuery("#ac input[name="+
jQuery(this).attr("name")+"]").attr("checked","checked")})};this.dealCateResult=function(a,e){a=a.categoryList;for(var b="",c=0;c<a.length;c++){b+="<li><input type=checkbox name='"+a[c].id+"' fullName='"+a[c].fullName+"'>"+a[c].categoryName;if(a[c].leaf==false)b+=" >> ";b+="</li>"}jQuery("#ac-grade"+e+"-list").html(b);jQuery("#ac-grade"+(e+1)+"-list").html("");jQuery(".ac-rightList-button").hide();if(e==4&&b!=""){jQuery("ul.ac-categorybox-list").children().eq(1).hide();jQuery("ul.ac-categorybox-list").children().eq(4).show();
jQuery(".ac-leftList-button").show()}if(e==5&&b!=""){jQuery("ul.ac-categorybox-list").children().eq(2).hide();jQuery("ul.ac-categorybox-list").children().eq(5).show()}jQuery("ul.ac-selected-box li").each(function(){jQuery("input[name="+jQuery(this).attr("name")+"]").attr("checked","checked")})};this.BindEvent=function(){var a=this,e;jQuery("div.cw-add-category").click(function(){jQuery(this).attr("navtype");var b=jQuery(this).attr("pid"),c="0";switch(b){case "cw-categorylist2":c=jQuery("#cw-categorylist1 .cw-item-icon-selected:visible").parent().attr("cid");
break;case "cw-categorylist3":c=jQuery("#cw-categorylist2 .cw-item-icon-selected:visible").parent().attr("cid");break;case "cw-categorylist4":c=jQuery(this).data("parentId");break;default:c="0";break}if(c==undefined){alert("\u5bf9\u4e0d\u8d77\uff0c\u8bf7\u9009\u62e9\u597d\u76f8\u5e94\u7684\u7236\u7c7b\u76ee");return false}jQuery("#ac-boxid").val(b);jQuery("#ac-parentid").val(c);if(e)e.show();else e=new Boxy("#ac",{modal:true,title:"\u6dfb\u52a0\u7c7b\u76ee",afterHide:function(){this.removeOtherNull();jQuery(".ac-categorylist-box").html("");jQuery(".ac-selected-box").html("");jQuery(".ac-result-box").html("");
jQuery("#ac-keyword").val("")},afterShow:function(){a.getCategory(-1,a.dealCateResult,1)}});return false});jQuery("#ac-grade1-list li").live("click",function(){jQuery(this).siblings().andSelf().removeClass("ac-item-active");jQuery(this).addClass("ac-item-active");var b=jQuery(this).find("input").attr("name");a.getCategory("categoryId="+b,a.dealCateResult,2)});jQuery("#ac-grade2-list li").live("click",function(){jQuery(this).siblings().andSelf().removeClass("ac-item-active");jQuery(this).addClass("ac-item-active");
var b=jQuery(this).find("input").attr("name");a.getCategory("categoryId="+b,a.dealCateResult,3)});jQuery("#ac-grade3-list li").live("click",function(){jQuery(this).siblings().andSelf().removeClass("ac-item-active");jQuery(this).addClass("ac-item-active");var b=jQuery(this).find("input").attr("name");a.getCategory("categoryId="+b,a.dealCateResult,4)});jQuery("#ac-grade4-list li").live("click",function(){jQuery(this).siblings().andSelf().removeClass("ac-item-active");jQuery(this).addClass("ac-item-active");
var b=jQuery(this).find("input").attr("name");a.getCategory("categoryId="+b,a.dealCateResult,5)});jQuery("#ac-grade5-list li").live("click",function(){jQuery(this).siblings().andSelf().removeClass("ac-item-active");jQuery(this).addClass("ac-item-active")});jQuery("#ac input[type=checkbox]").live("click",function(b){var c=jQuery(this).attr("name").trim();if(jQuery(this).attr("checked")=="checked"){jQuery("#ac input[name='"+c+"']").attr("checked",true);a.addSelectedItem(c,jQuery(this).attr("fullName"))}else{jQuery("#ac input[name='"+
c+"']").attr("checked",false);jQuery("#ac li[name='"+c+"']").remove()}b.stopPropagation()});jQuery("ul.ac-result-box li").live("click",function(){jQuery(this).find("input").attr("checked",jQuery(this).find("input").attr("checked")=="checked"?false:true);if(jQuery(this).find("input").attr("checked")=="checked"){jQuery("#ac input[name="+jQuery(this).find("input").attr("name")+"]").attr("checked",true);a.addSelectedItem(jQuery(this).find("input").attr("name"),jQuery(this).find("input").attr("fullName"))}else{jQuery("#ac input[name="+
jQuery(this).find("input").attr("name")+"]").attr("checked",false);jQuery("ul.ac-selected-box li[name="+jQuery(this).attr("name")+"]").remove()}});jQuery("ul.ac-selected-box li").live("hover",function(){jQuery("ul.ac-selected-box span.ac-delete-button").hide();jQuery(this).find("span.ac-delete-button").show();jQuery(this).toggleClass("ac-selected-hover")});jQuery("ul.ac-categorylist-box li").live("hover",function(){jQuery(this).css("cursor","pointer")});jQuery("ul.ac-result-box li").live("hover",
function(){jQuery(this).css("cursor","pointer")});jQuery("span.ac-delete-button").live("click",function(){jQuery(this).parent().remove();jQuery("#ac input[name="+jQuery(this).parent().attr("name")+"]").attr("checked",false)});jQuery("#ac-form-button-search").click(function(){var b=jQuery("#ac-keyword").attr("value");b==""||b==null?alert("\u8bf7\u8f93\u5165\u5173\u952e\u5b57"):a.getCategory("keyword="+b,a.dealSearchResult)});jQuery("#ac-form-button-close").click(function(){e.hide();return false});jQuery("#ac-form-button-add").live("click",
function(){var b=jQuery("#pageId").val(),c=jQuery("#ac-boxid").val(),g=jQuery("#ac-parentid").val(),h="A",i="",l="";switch(c){case "cw-categorylist1":h="A";g=0;break;case "cw-categorylist2":h="B";g=jQuery("#cw-categorylist1 .cw-item-icon-selected:visible").parent().attr("cid");break;case "cw-categorylist3":g=jQuery("#cw-categorylist2 .cw-item-icon-selected:visible").parent().attr("cid");h="N";break;case "cw-categorylist4":h="H";break}var j=jQuery("#"+c).find("li").last().attr("orderId"),m=0;m=j==
undefined||j==null?0:parseInt(j);j=[];var p=[],q=[],r=[],s=[],u=[],t=[],k=[],d={},n=jQuery(".ac-selected-box li");if(n.length<1)return false;for(var f=0;f<n.length;f++){d={};i=n.eq(f).find(".ac-category-full-name").text();l=i.split(">>");l=l[l.length-1];d.searchKeyword="";d.showKeyword="";d.showName=l;d.fullCategoryName=i;d.categoryId=n.eq(f).attr("name");d.orderId=f+m+1;d.treeList=[];d.hotList=[];d.isHotKey=c=="cw-categorylist4"?true:false;d.defaultUrlId=jQuery("input[name='urlRule']:checked").val();
d.category=true;d.parentId=g;d.navType=h;d.colorFlag="N";d.hotFlag="N";d.newFlag="N";d.customUrl="#";if(d.categoryName==""){alert("\u8bf7\u586b\u5199\u5b8c\u6574\u7684\u7c7b\u76ee\u540d\u79f0");return false}else{j.push("");p.push("");q.push(encodeURIComponent(d.fullCategoryName));r.push(d.categoryId);u.push(h);t.push(d.orderId);s.push(d.defaultUrlId);k.push(d)}}m=jQuery("#"+c+" li");for(f=0;f<k.length;f++)for(i=0;i<m.length;i++)if(m.eq(i).text()==k[f].showName){alert(k[f].showName+"\u8fd9\u6761\u4fe1\u606f\u5b58\u5728\u91cd\u590d\uff01");return false}jQuery.ajax({type:"post",dataType:"json",
traditional:true,url:get_elf_url()+"/tools/add_nav.do?charset=utf-8",data:{act:"C",dataCount:n.length,pageId:b,parentId:g,orderId:t,defaultUrlId:s,searchKeyword:j,showKeyword:p,categoryId:r,fullCategoryName:q,navType:h},cache:false,success:function(o){if(o.msg){alert(o.msg);return false}else if(o.ids){for(f=0;f<o.ids.length;f++)k[f].id=o.ids[f];(new Citem("0")).addItem("1",c,k);e.hide();return true}else{alert("\u589e\u52a0\u5931\u8d25\uff01");return false}},error:function(){}})});jQuery(".ac-leftList-button").click(function(){jQuery("ul.ac-categorybox-list").children().eq(1).show();
jQuery("ul.ac-categorybox-list").children().eq(2).show();jQuery("ul.ac-categorybox-list").children().eq(4).hide();jQuery("ul.ac-categorybox-list").children().eq(5).hide();jQuery(this).hide();jQuery(".ac-rightList-button").show()});jQuery(".ac-rightList-button").click(function(){jQuery("ul.ac-categorybox-list").children().eq(1).hide();jQuery("ul.ac-categorybox-list").children().eq(2).hide();jQuery("ul.ac-categorybox-list").children().eq(4).show();jQuery("ul.ac-categorybox-list").children().eq(5).show();
jQuery(this).hide();jQuery(".ac-leftList-button").show()})}};
