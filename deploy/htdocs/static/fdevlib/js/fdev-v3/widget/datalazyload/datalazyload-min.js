(function(l){var b=YAHOO.lang,f=window,k=document,g="data-lazyload-src",d="default",j="scroll",a="resize",m="img",c=null,i="fn-lazyload",e="data-fn",h={fnThreshold:d,threshold:d,elements:m,onComplete:c,onLoad:c};l.DataLazyload=function(p,o){var n=this,q="";if(!(n instanceof arguments.callee)){return new arguments.callee(p,o)}if(!b.isArray(p)){p=[FYG(p)||k]}n.containers=p;n.config=FD.common.applyIf(o||{},h);q=n.config.fnThreshold;n.config.fnThreshold=q===d?n.config.threshold:q;this._init()};b.augmentObject(l.DataLazyload.prototype,{_init:function(){var n=this;n.threshold=n._getThreshold(n.config.threshold);n.fnThreshold=n._getThreshold(n.config.fnThreshold);n._filterItems();n._getItemsLength()&&n._initLoadEvent()},_filterItems:function(){var p=this,s=p.containers,v,t,u,o=[],q,r=[];for(v=0,t=s.length;v<t;++v){u=FYS(p.config.elements,s[v]);o=o.concat(u.filter(p._filterImg,p));q=FYS(("."+i),s[v]);r=r.concat(q.filter(p._filterFn,p))}p.images=o;p.fns=r},_filterImg:function(o){var n=this,p=o.getAttribute(g);if(p){return true}},_filterFn:function(p){var n=this,o=p.getAttribute(e);if(o){return true}},_getItemsLength:function(){return this.images.length+this.fns.length},_initLoadEvent:function(){var q,p=this;FYE.on(f,j,n);FYE.on(f,a,function(){p.threshold=p._getThreshold(p.config.threshold);p.fnThreshold=p._getThreshold(p.config.fnThreshold);n()});if(p._getItemsLength()){FYE.onDOMReady(function(){o()})}function n(){if(q){return}q=setTimeout(function(){o();q=null},100)}function o(){p._loadItems();if(p._getItemsLength()===0){if(typeof p.config.onComplete==="function"){p.config.onComplete()}p.config.onComplete=null;FYE.removeListener(f,j,n);FYE.removeListener(f,a,n)}}},_loadItems:function(){this._loadImgs();this._loadFns()},_loadImgs:function(){var n=this;n.images=n.images.filter(n._loadImg,n)},_loadImg:function(p){var o=this,q=FYD.getDocumentScrollTop(),n=o.threshold+q,r=FYD.getRegion(p);if(r.top<=n){if(typeof o.config.onLoad=="function"){FYE.on(p,"load",function(){o.config.onLoad(p)})}o._loadImgSrc(p)}else{return true}},_loadImgSrc:function(n){var o=n.getAttribute(g);if(o&&n.src!=o){n.src=o;n.removeAttribute(g)}},_loadFns:function(){var n=this;n.fns=n.fns.filter(n._loadFn,n)},_loadFn:function(p){var o=this,q=FYD.getDocumentScrollTop(),n=o.fnThreshold+q,r=FYD.getRegion(p);if(r.top<=n){o._instantiatedFn(p)}else{return true}},_instantiatedFn:function(o){var n=this,q=o.getAttribute(e),p;if(q!=null){p=n._parseFunction(q);if(p.length==2){p[0](o)}if(q){o.removeAttribute(e)}}},_getThreshold:function(n){var o=FYD.getViewportHeight();if(n===d){return 2*o}else{return o+n}},_parseFunction:function(q){var n=q.split("."),o,p=window;for(o=n[0]==="window"?1:0;o<n.length-1;o++){if(typeof p[n[o]]=="object"){p=p[n[o]]}else{return[]}}if(FDEV.lang.isFunction(p[n[n.length-1]])){return[p[n[n.length-1]],p]}return[]},end:0})})(FD.widget);