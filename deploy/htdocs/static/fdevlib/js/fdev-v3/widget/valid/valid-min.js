(function(widget){var regExps={isFloat:/^[-\+]?\d+(\.\d+)?$/,isUrl:/^(http|https):\/\//,isEmail:/^[\w\-]+(\.[\w\-]*)*@[\w\-]+([\.][\w\-]+)+$/,isMobile:/^1\d{10}$/,isInt:/^[-\+]?\d+$/,isID:/^\d{17}[\d|X]|\d{15}$/},rtrim=/^[\s\u00A0\u3000]+|[\s\u00A0\u3000]+$/g,fireEventHandler=function(el,e){if(window.ActiveXObject){el.fireEvent("on"+e)}else{var evt=document.createEvent("HTMLEvents");evt.initEvent(e,true,true);el.dispatchEvent(evt)}},enterPressHandler=function(e,el){if(e.keyCode==13){fireEventHandler(el,"blur")}};Valid=function(els,opts){this._els=[];this._elConfigs=[];if(opts&&opts.onValid){this.onValid=opts.onValid}if(els.length){this.add(els)}},val=function(el,o){switch(el.tagName.toLowerCase()){case"input":var type=el.type.toLowerCase();if(type=="text"||type=="password"){if(o.trim){el.value=el.value.replace(rtrim,"")}return el.value}if(type=="password"){return el.value}if(type=="radio"||type=="checkbox"){return el.checked?"checked":""}return el.value;case"textarea":default:if(o.trim){el.value=el.value.replace(rtrim,"")}return el.value;case"select":return el.selectedIndex<0?null:el.options[el.selectedIndex].value}},validHandler=function(e,obj){var el=obj.el,cfg=obj.cfg,o=obj.opt,value=val(el,o);if(!o.active){return}if(o.lazy){if(value==o.defValue){return}o.lazy=false}if(o.cache&&value==o.value){return}var onValid=o.onValid||this.onValid;if(o.cache){cfg.value=value}cfg.isValid=o.isValid=false;if(!value){if(o.required){return onValid.call(el,"required",o)}if(o.type!="fun"){cfg.isValid=o.isValid=true;return onValid.call(el,"pass",o)}}switch(o.type){case"string":var sval=value.replace(/\r\n/g,"**").replace(/\n/g,"**");if(null!=o.min&&sval.length<o.min){return onValid.call(el,"min",o)}if(null!=o.max&&sval.length>o.max){return onValid.call(el,"max",o)}break;case"float":if(!regExps.isFloat.test(value)){return onValid.call(el,"float",o)}var fval=value*1;if(null!=o.round){fval=fval.toFixed(o.round)}if(o.cache){cfg.value=value}if(null!=o.min&&fval<o.min){return onValid.call(el,"min",o)}if(null!=o.max&&fval>o.max){return onValid.call(el,"max",o)}break;case"int":if(!regExps.isInt.test(value)){return onValid.call(el,"int",o)}var ival=value*1;if(null!=o.min&&ival<o.min){return onValid.call(el,"min",o)}if(null!=o.max&&ival>o.max){return onValid.call(el,"max",o)}break;case"email":if(!regExps.isEmail.test(value)){return onValid.call(el,"email",o)}break;case"mobile":if(!regExps.isMobile.test(value)){return onValid.call(el,"mobile",o)}break;case"url":if(!regExps.isUrl.test(value)){return onValid.call(el,"url",o)}break;case"reg":if(!o.reg.test(value)){return onValid.call(el,"reg",o)}break;case"fun":o.msg=o.fun.call(el,o);if(typeof o.msg=="string"){return onValid.call(el,"fun",o)}break;case"remote":return o.fun.call(el,{cfg:cfg,opt:o},onValid);break;default:return onValid.call(el,"unkown",o)}cfg.isValid=o.isValid=true;return onValid.call(el,"pass",o)},defaults={active:true,lazy:true,required:false,evt:"blur",type:"string",trim:true,round:2,cache:true};Valid.prototype={onValid:function(){return true},add:function(els){if(els.nodeType){els=[els]}var o;for(var i=0,j=els.length;i<j;i++){if(this._els.indexOf(els[i])>-1){continue}this._els.push(els[i]);try{o=FD.common.applyIf(eval("("+($D.getAttribute(els[i],"valid")||"{}")+")"),defaults);o.defValue=val(els[i],o)}catch(ex){if(window.console){console.info(" Ù–‘valid∏Ò Ω¥ÌŒÛ:"+$D.getAttribute(els[i],"valid"))}}this._elConfigs.push(o);FYE.on(els[i],o.evt,validHandler,{el:els[i],cfg:o,opt:o},this);if(els[i].nodeName=="INPUT"){FYE.on(els[i],"keydown",enterPressHandler,els[i],this)}}},remove:function(els){if(typeof els=="number"){if(els<this._els.length){els=[this._els[els]]}else{return}}if(els.nodeType){els=[els]}var o,idx;for(var i=0,j=els.length;i<j;i++){idx=this._els.indexOf(els[i]);if(idx<0){continue}o=this._elConfigs[idx];FYE.removeListener(this._els[idx],o.evt,validHandler);if(this._els[idx].nodeName=="INPUT"){FYE.removeListener(this._els[idx],"keydown",enterPressHandler)}this._els.removeAt(idx);this._elConfigs.removeAt(idx)}},active:function(els,mark){if(typeof els=="string"||typeof els=="boolean"||els==null){mark=els;els=this._els}if(typeof els=="number"){if(els<this._els.length){els=[this._els[els]]}else{return}}if(els.nodeType){els=[els]}var o,idx;for(var i=0,j=els.length;i<j;i++){idx=this._els.indexOf(els[i]);if(idx<0){continue}o=this._elConfigs[idx];if(mark==null||mark==true){if(o.active){continue}o.active=true}else{if(mark=="op"){o.active=!o.active}else{if(!o.active){continue}o.active=false}}if(o.active){delete o.isValid}else{(o.onValid||this.onValid).call(this._els[idx],"default",o);delete o.value}}},valid:function(els,configs,disFocus){if(typeof els=="number"){if(els<this._els.length){els=[this._els[els]]}else{return}}if(!els){els=this._els}if(els.nodeType){els=[els]}var k;for(var i=0,j=els.length;i<j;i++){var o={},idx=this._els.indexOf(els[i]);if(idx<0){continue}FD.common.apply(o,this._elConfigs[idx]);if(configs){FD.common.apply(o,configs)}if(!o.active){continue}o.lazy=false;if(o.isValid!=true||!o.cache){if(o.isValid==null||!o.cache){o.isValid=false;delete o.defValue;validHandler.call(this,null,{el:this._els[idx],cfg:this._elConfigs[idx],opt:o})}if(o.isValid==false&&k==null){k=idx}}}if(k!=null){if(!disFocus){this._els[k].focus()}return false}return true},getConfig:function(el){var i=(typeof el=="number"?el:this._els.indexOf(el));return i<0?null:this._elConfigs[i]},setConfig:function(els,configs){if(typeof els=="number"){if(els<this._els.length){els=[this._els[els]]}else{return}}if(!els){els=this._els}if(els.nodeType){els=[els]}for(var i=0,j=els.length;i<j;i++){var idx=this._els.indexOf(els[i]);if(idx<0){continue}FD.common.apply(this._elConfigs[idx],configs)}}};Valid.regExps=regExps;widget.Valid=Valid})(FD.widget);