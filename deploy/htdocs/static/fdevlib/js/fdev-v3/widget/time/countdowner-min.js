FD.widget.CountDown=function(B,A){this.init(B,A)};FD.widget.CountDown.defConfig={countUp:0,classOfConts:["cd-year","cd-month","cd-day","cd-hour","cd-minute","cd-second"],topBound:2,numClassPrefix:"num",outputType:0,nowTime:new Date(),desTime:new Date("2010","2","8","0","0","0"),cdStep:1};FD.widget.CountDown.prototype={Status:1,DValue:0,DValueArr:[0,0,0,0,0,0],init:function(B,A){if(FYG(B)){this.config=FD.common.applyIf(A||{},FD.widget.CountDown.defConfig);this.obj=FYG(B);this.run()}},run:function(A){if(A){this.config.nowTime=new Date(this.config.nowTime.getTime()+A)}else{var A=this.config.cdStep*1000}this.calcDValue();this.calcDValueArr();if(this.DValue<=0){this.Status=0;this.DValue=0;this.DValueArr=[0,0,0,0,0,0]}var D=this.config.classOfConts;var B=this.DValueArr;this.setInnerHTML(D[0],B[0],4);this.setInnerHTML(D[1],B[1]);this.setInnerHTML(D[2],B[2]);this.setInnerHTML(D[3],B[3]);this.setInnerHTML(D[4],B[4]);this.setInnerHTML(D[5],B[5]);if(!this.Status){return}var C=this;window.setTimeout(function(){C.run(A)},A)},calcDValue:function(){if(this.config.countUp==1){this.DValue=this.config.nowTime.getTime()-this.config.nowTime.getTimezoneOffset()*60000}else{this.DValue=this.config.desTime.getTime()-this.config.nowTime.getTime()}},calcDValueArr:function(){var F=new Date(this.DValue);var B=this.DValueArr;var A=this.config.topBound;var E=[F.getUTCFullYear(),F.getUTCMonth(),F.getUTCDate()-1,F.getUTCHours(),F.getUTCMinutes(),F.getUTCSeconds()];var D=[null,null,86400000,3600000,60000,1000];if(this.config.countUp||!A){B[0]=E[0];B[1]=E[1]+1;B[2]=E[2]+1;B[3]=E[3];B[4]=E[4];B[5]=E[5]}else{var C=B.length;while(C-->0){if(A==C&&C!=1){B[C]=parseInt(this.DValue/D[C]);break}else{if(A==C&&C==1){B[C]=E[1]+12*(E[0]-1970);break}else{B[C]=E[C]}}}}},getNumStr:function(C){var B="";for(var A=0;A<C.length;A++){B+='<q class="cd-q'+A+'"><p class="'+C[A]+'">'+C[A]+"</p></q>"}return B},genClassArr:function(B){var A=B.replace(/(\d)/ig,","+this.config.numClassPrefix+"$1");A=A.split(",");A=A.slice(1);return A},doAnim:function(B,A){},setInnerHTML:function(A,E,B){var C,B=B||2;if((C=FYD.getElementsByClassName(A,"*",this.obj))&&C.length){var D=C[0];E=E+"";while(E.length<B){E="0"+E}if(this.config.outputType){if(this.config.effect&&D.innerHTML.match(/<q[^>]*>/ig)){this.doAnim(D,this.genClassArr(E))}else{D.innerHTML=this.getNumStr(this.genClassArr(E))}}else{D.innerHTML=E}}}};FD.widget.CountDownScroll=function(B,A){this.init(B,A)};YAHOO.extend(FD.widget.CountDownScroll,FD.widget.CountDown,{doAnim:function(H,G){var C=H.getElementsByTagName("q");var E=C.length;while(E-->0){var D=C[E].getElementsByTagName("p");if(D.length&&G[E]&&G[E]!=D[0].className){if(D.length==1){var A=document.createElement("p");C[E].appendChild(A)}else{var A=D[1]}A.className=G[E];var B={scroll:{to:[0,D[0].offsetHeight]}};var F=new FYU.Scroll(C[E],B,0.5);F.onComplete.unsubscribeAll();F.onComplete.subscribe(function(J,I,K){K.appendChild(FYD.getFirstChild(K));K.scrollTop=0},C[E]);F.animate()}}}});FD.widget.CountDowner=new function(){this.init=function(B,A){if(FYG(B)){if(A.effect=="scroll"){return new FD.widget.CountDownScroll(B,A)}else{return new FD.widget.CountDown(B,A)}}}};
