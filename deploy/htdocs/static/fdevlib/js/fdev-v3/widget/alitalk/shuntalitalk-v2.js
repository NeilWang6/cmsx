FD.widget.ShuntAlitalk=function(a,b){this._init(a,b)};FD.widget.ShuntAlitalk.defConfig={aliTalkId:"aliservice29",ruleId:"ALITALK_INCALL_ROLE_CTP01",positionId:"Top_Banner",attname:"rel",lock:true,lockclass:"shunt-lock",remote:false,autoLogin:false};FD.widget.ShuntAlitalk.prototype={_init:function(a,b){var c=this;c.container=FYD.getElementsByClassName(a);c.config=FD.common.applyIf(b||{},FD.widget.ShuntAlitalk.defConfig);c.classfocus=a;FYE.on(c.container,"mouseover",c._overHandler,c,true);(c.container).forEach(function(e){var f=FD.common.parse(FYD.getAttribute(e,c.config.attname));c._setTalkId(e,f)})},_overHandler:function(c){FYE.preventDefault(c);var a=this,b=FYE.getTarget(c);if(!FYD.hasClass(b,a.classfocus)){b=FYD.getAncestorByClassName(b,a.classfocus)}var f=FD.common.parse(FYD.getAttribute(b,a.config.attname));a.config=FD.common.applyIf(f||{},a.config);if(!FYD.hasClass(b,a.config.lockclass)){a._requestHandler(b)}},_requestHandler:function(b){var a=this,e={};e.memberId=FD.common.lastLoginId;e.ruleId=a.config.ruleId;e.positionId=a.config.positionId;var d={onCallback:function(f){if(f.success){switch(f.resultType){case"aliYUrl":FD.common.goTo(f.aliTalkId,"_blank");break;case"alitalkId":default:if(a.config.lock){FYD.addClass(b,a.config.lockclass)}a._setTalkId(b,f);a._shuntTalk(b);break}}else{a._setTalkId(b,f);a._shuntTalk(b)}},onTimeout:function(f){a._shuntTalk(b)}};var c=FD.common.request("jsonp","http://athena.1688.com/athena/aliTalkInCall.json",d,e)},_setTalkId:function(c,d){var b=this,a=d.aliTalkId||b.config.aliTalkId;FYD.setAttribute(c,"alitalk","{id:'"+a+"'}")},_shuntTalk:function(b){var a=this;if(typeof FD.widget.Alitalk==="undefined"){var d={onSuccess:function(e){new FD.widget.Alitalk(b,{remote:a.config.remote,autoLogin:a.config.autoLogin})}};var c=FD.common.request("jsonp","http://style.c.aliimg.com/js/lib/fdev-v3/widget/alitalk/alitalk-min.js",d)}else{new FD.widget.Alitalk(b,{remote:a.config.remote,autoLogin:a.config.autoLogin})}}};