(function(e){if(window.FE&&FE.sys){return}function f(h){return FE.test&&FE.test[h]}e.namespace("FE.sys","FE.util.jasmine","FE.ui");var g=FE.util,d=e.util.cookie,b=e.support;g.LoginId=function(){var h=d("__cn_logon_id__",{raw:true});return h&&decodeURIComponent(h)};g.loginId=g.LoginId();g.IsLogin=function(){return(g.LoginId()?true:false)};g.isLogin=g.IsLogin();g.LastLoginId=function(){var h=d("__last_loginid__",{raw:true});return h&&decodeURIComponent(h)};g.lastLoginId=g.LastLoginId();g.getLastMemberId=function(){var h=d("last_mid",{raw:true});return h&&decodeURIComponent(h)};g.updateLoginInfo=function(k){k=e.extend({source:["b2b","taobao"]},k);var i=new e.Deferred,j=k.source,m=0;l(j[m]);function l(o){var n=g["updateLoginInfoFrom"+o.substr(0,1).toUpperCase()+o.substr(1)];if(e.type(n)==="function"){e.when(n(i)).always(function(){if(g.IsLogin()){i.resolve()}else{h()}})}else{e.log(o+" is not a function");h()}}function h(){if(++m<j.length){l(j[m])}else{i.resolve()}}return i};g.updateLoginInfoFromB2b=function(){var h=new e.Deferred;h.resolve();return h.promise()};g.updateLoginInfoFromTaobao=function(){var h=new e.Deferred;g.getLoginInfoFromTaobao().always(function(k){var j=k.__cn_logon_id__,i=k.__last_memberid__;if(j){j=encodeURIComponent(j);e.use("util-cookie",function(){var l={raw:true};if(/\balibaba\.com$/.test(location.hostname)){l.domain="alibaba.com";l.path="/"}else{if(/\b1688\.com$/.test(location.hostname)){l.domain="1688.com";l.path="/"}}e.util.cookie("__cn_logon_id__",j,l);e.util.cookie("__last_loginid__",j,e.extend({expires:30},l));e.util.cookie("__cn_logon__",true,l);i&&e.util.cookie("last_mid",encodeURIComponent(i),l);g.loginId=j;g.isLogin=true;h.resolve(k)})}else{h.resolve(k)}});return h.promise()};g.getLoginInfoFromTaobao=function(){var h=f("style.logintaobao.sync.url")||"http://b2bsync.taobao.com/tbc";return e.ajax({url:h,dataType:"jsonp"}).promise()};g.isLoginIdAutoGen=function(){return/^b2b-.+/.test(g.LoginId())};g.goTo=function(i,l){var k="_self";l=l||k;if(!e.util.ua.ie){return window.open(i,l)}var j=document.createElement("a"),h=document.body;j.setAttribute("href",i);j.setAttribute("target",l);j.style.display="none";h.appendChild(j);j.click();if(l!==k){setTimeout(function(){try{h.removeChild(j)}catch(m){}},200)}return};g.is1688=function(){var h=window.location.hostname,i=/\b1688\.com$/;return i.test(h)};var a=g.jasmine,c;e.extend(a,{stack:[],add:function(h){if(c){e.getScript(h)}else{a.stack.push(h)}}});if(b.JSON){e.add("util-json")}if(!window.console){window.console={};console.log=console.info=e.log}e(function(){e.DEBUG=/debug=true/i.test(location.search);if(e.DEBUG){e.use("util-debug")}e.JASMINE=/jasmine=true/i.test(location.search);if(e.JASMINE){e.add("ext-jasmine-specs",{requires:["ext-jasmine"],js:a.stack});e.use("ext-jasmine-specs",function(){e.use("ext-jasmine-html, ext-jasmine-jquery",function(){a.Env=jasmine.getEnv();var h=new jasmine.TrivialReporter();a.Env.addReporter(h);a.Env.specFilter=function(i){return h.specFilter(i)};c=true})})}});FE.test={}})(jQuery);