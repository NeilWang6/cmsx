FDEV.namespace("FD.sys.head");(function(a){a.search={categoriesMap:{product:{url:"http://page.1688.com/buy/index.html",action:"http://s.1688.com/search/offer_search.htm",placeholder:"\u8f93\u5165\u4ea7\u54c1\u540d\u79f0"},company:{url:"http://page.1688.com/cp/cp1.html",action:"http://s.1688.com/search/company_search.htm",placeholder:"\u8f93\u5165\u516c\u53f8\u540d\u79f0\u6216\u5173\u952e\u8bcd"},buy:{url:"http://page.1688.com/cp/cp8.html",action:"http://s.1688.com/search/search.htm",placeholder:"\u8f93\u5165\u4ea7\u54c1\u540d\u79f0"},baike:{url:"http://baike.1688.com/",action:"http://s.1688.com/search/wiki_answer_search.htm",placeholder:"\u8f93\u5165\u95ee\u9898\u5173\u952e\u8bcd"},pifa:{url:"http://pifa.1688.com/",action:"http://s.1688.com/search/business_search.htm",placeholder:"\u8f93\u5165\u4ea7\u54c1\u540d\u79f0"},trust:{url:"http://page.1688.com/trust/safeguard.html",action:"http://trust.china.alibaba.com/athena/trustsearch.html",placeholder:"\u8f93\u5165\u516c\u53f8\u540d\u79f0\u6216\u5173\u952e\u8bcd"},info:{url:"http://info.1688.com/",action:"http://s.1688.com/search/news_search.htm",placeholder:"\u8f93\u5165\u4fe1\u606f\u5173\u952e\u8bcd"},club:{url:"http://club.1688.com/",action:"http://s.1688.com/search/forum_search.htm",placeholder:"\u8f93\u5165\u4fe1\u606f\u5173\u952e\u8bcd"},blog:{url:"http://blog.1688.com/",action:"http://s.1688.com/search/blog_search.htm",placeholder:"\u8f93\u5165\u4fe1\u606f\u5173\u952e\u8bcd"},video:{url:"http://video.1688.com/",action:"http://video.1688.com/video/search/search_list.html",placeholder:"\u8f93\u5165\u4fe1\u606f\u5173\u952e\u8bcd"},end:0},isFocus:0,isExt:0,isSuggest:0,isPlaceholder:function(){return !!("placeholder" in document.createElement("input"))},getIsExt:function(){if(["info","club","blog"].indexOf(this.getCurrentType())>-1){this.isExt=1;this.nodes.ext=this.nodes.current}},getCurrentType:function(){var b=this.nodes.current.getAttribute("data-type").trim();return b},placeholder:function(){var b=this.nodes.input,f=this,d=this.isPlaceholder(),c;if(this.isFocus){b.focus()}else{d?b.setAttribute("placeholder",f.categoriesMap[f.getCurrentType()]["placeholder"]):e(b)}if(d){return}$E.addListener(b,"focus",function(){clearTimeout(c);if($D.hasClass(this,"placeholder")){this.value="";$D.removeClass(this,"placeholder")}f.isFocus=1});$E.addListener(b,"blur",function(){if(this.value.trim()===""){e(this)}c=setTimeout(function(){f.isFocus=0},200)});function e(g){$D.addClass(g,"placeholder");g.value=f.categoriesMap[f.getCurrentType()]["placeholder"]}},changePlaceholder:function(c){var d=this.categoriesMap[c]["placeholder"],b=this.nodes.input;b.setAttribute("placeholder",d);this.nodes.form.setAttribute("action",this.categoriesMap[c]["action"]);if($D.hasClass(b,"placeholder")){b.value=d}if(this.isFocus){b.focus()}},basicChangeCategory:function(){var c=this,b=this.nodes;$E.delegate(this.nodes.basicList,"click",function(g){$E.preventDefault(g);var d=this.parentNode.parentNode,f=d.getAttribute("data-type").trim();if(d===b.current){return}$D.removeClass(b.current,"current");b.current=d;$D.addClass(b.current,"current");c.changePlaceholder(f)},"a")},searchOver:function(){var c=this.nodes.extBox,d,b;$E.addListener(c,"mouseover",function(){clearTimeout(b);var e=this;d=setTimeout(function(){$D.addClass(e,"search-over")},200)});$E.addListener(c,"mouseout",function(){clearTimeout(d);var e=this;b=setTimeout(function(){$D.removeClass(e,"search-over")},200)});$E.addListener("searchMore","click",function(f){$E.preventDefault(f)})},extChangeCategory:function(){this.searchOver();this.getIsExt();var c=this,b=this.nodes;$E.delegate(this.nodes.extList,"click",function(g){$E.preventDefault(g);var d=this.parentNode.parentNode,f=d.getAttribute("data-type").trim();if(c.isExt){$D.removeClass(b.current,"current");b.current=d;$D.addClass(b.current,"current");$D.removeClass(b.ext,"current");b.extList.appendChild(b.ext);b.ext=d;b.basicList.appendChild(d)}else{$D.removeClass(b.current,"current");b.current=d;$D.addClass(b.current,"current");b.ext=d;b.basicList.appendChild(b.current);$D.removeClass(b.extBox,"search-over");c.isExt=1}c.changePlaceholder(f)},"a")},checkSubmit:function(){var c=this,b=this.nodes;$E.addListener(b.form,"submit",function(h){var f=b.input.value.trim(),d=c.categoriesMap[c.getCurrentType()],g=!!d.target?d.target:"_blank";if((f!=="")&&(f!==d.placeholder)){this.setAttribute("target",g);if(!!d.tracelog){aliclick(this,"?tracelog="+d.tracelog)}}else{$E.preventDefault(h);FD.common.goTo(d.url,g);return false}})},initSuggest:function(){var c=this,b;$E.addListener(this.nodes.input,"focus",function(){if(!c.isSuggest){$Y.Get.css("http://style.c.aliimg.com/css/sys/head/autocomplete.css");if(typeof FD.widget.AutoComplete==="undefined"){var d="http://style.c.aliimg.com/js/fdevlib/widget/autocomplete/fdev-autocomplete-min.js",f={onSuccess:function(h){b=setTimeout(e,200)}},g=FD.common.request("jsonp",[d],f)}else{e()}c.isSuggest=1}function e(){FD.widget.AutoComplete.init(c.nodes.suggest,{charset:"gb2312",pX:4,pY:17,pW:35,formName:"alisearch",isAnim:false,isShowShut:false})}})},init:function(){this.nodes={form:$("aliSearchForm"),input:$("aliSearchInput"),suggest:$("searchBodyContainer"),basicList:$("searchCategoriesList"),extList:$("moreSearchCategoriesList"),extBox:$$(".search-categories .search-ext")[0],current:$$("#searchCategoriesList .current")[0],ext:null};this.placeholder();this.basicChangeCategory();this.extChangeCategory();this.checkSubmit();this.initSuggest()},end:0};$E.onDOMReady(function(){a.search.init()})})(FD.sys.head);
