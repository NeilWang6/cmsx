FDEV.namespace("FD.sys.head");(function(b,a){a.search={categoriesMap:{combo:{url:"http://s.1688.com/combo/index.htm",action:"http://s.1688.com/search/smart_search.htm",placeholder:"输入关键词"},product:{url:"http://page.1688.com/buy/index.html",action:"http://s.1688.com/search/offer_search.htm",placeholder:"输入产品名称"},company:{url:"http://page.1688.com/cp/cp1.html",action:"http://s.1688.com/search/company_search.htm",placeholder:"输入公司名称或关键词"},buy:{url:"http://page.1688.com/cp/cp8.html",action:"http://s.1688.com/search/search.htm",placeholder:"输入产品名称"},baike:{url:"http://baike.1688.com/",action:"http://s.1688.com/search/wiki_answer_search.htm",placeholder:"输入问题关键词"},pifa:{url:"http://pifa.1688.com/",action:"http://s.1688.com/search/business_search.htm",placeholder:"输入产品名称"},trust:{url:"http://page.1688.com/trust/safeguard.html",action:"http://trust.china.alibaba.com/athena/trustsearch.html",placeholder:"输入公司名称或关键词"},info:{url:"http://info.1688.com/",action:"http://s.1688.com/search/news_search.htm",placeholder:"输入信息关键词"},club:{url:"http://club.1688.com/",action:"http://s.1688.com/search/forum_search.htm",placeholder:"输入信息关键词"},blog:{url:"http://blog.1688.com/",action:"http://s.1688.com/search/blog_search.htm",placeholder:"输入信息关键词"},video:{url:"http://video.1688.com/",action:"http://video.1688.com/video/search/search_list.html",placeholder:"输入信息关键词"},end:0},isFocus:0,isExt:0,isSuggest:0,isPlaceholder:function(){return !!("placeholder" in document.createElement("input"))},getIsExt:function(){if(["info","club","blog","video"].indexOf(this.getCurrentType())>-1){this.isExt=1;this.nodes.ext=this.nodes.current}},getCurrentType:function(){var c=this.nodes.current.getAttribute("data-alisearch-type").trim();return c},placeholder:function(){var c=this.nodes.input,g=this.nodes.form,i=this,e=this.isPlaceholder(),f=i.getCurrentType(),d;g.setAttribute("action",i.categoriesMap[f]["action"]);if(this.isFocus){c.focus()}else{e?c.setAttribute("placeholder",i.categoriesMap[f]["placeholder"]):h(c)}if(e){return}$E.addListener(c,"focus",function(){clearTimeout(d);if($D.hasClass(this,"placeholder")){this.value="";$D.removeClass(this,"placeholder")}i.isFocus=1});$E.addListener(c,"blur",function(){if(this.value.trim()===""){h(this)}d=setTimeout(function(){i.isFocus=0},200)});function h(j){$D.addClass(j,"placeholder");j.value=i.categoriesMap[i.getCurrentType()]["placeholder"]}},changePlaceholder:function(d){var e=this.categoriesMap[d],f=e.placeholder,c=this.nodes.input;c.setAttribute("placeholder",f);this.nodes.form.setAttribute("action",e.action);if($D.hasClass(c,"placeholder")){c.value=f}if(this.isFocus){c.focus()}},basicChangeCategory:function(){var d=this,c=this.nodes;$E.delegate(this.nodes.basicList,"click",function(h){$E.preventDefault(h);var f=this.parentNode.parentNode,g=f.getAttribute("data-alisearch-type").trim();if(f===c.current){return}$D.removeClass(c.current,"alisearch-current");c.current=f;$D.addClass(c.current,"alisearch-current");d.changePlaceholder(g)},"a")},searchOver:function(){var d=this.nodes.extBox,e,c;$E.addListener(d,"mouseover",function(){clearTimeout(c);var f=this;e=setTimeout(function(){$D.addClass(f,"alisearch-over")},200)});$E.addListener(d,"mouseout",function(){clearTimeout(e);var f=this;c=setTimeout(function(){$D.removeClass(f,"alisearch-over")},200)});$E.addListener("alisearch-more","click",function(f){$E.preventDefault(f);return false})},extChangeCategory:function(){this.searchOver();this.getIsExt();var d=this,c=this.nodes;$E.delegate(c.extList,"click",function(h){$E.preventDefault(h);var f=this.parentNode.parentNode,g=f.getAttribute("data-alisearch-type").trim();if(d.isExt){$D.removeClass(c.current,"alisearch-current");c.current=f;$D.addClass(c.current,"alisearch-current");$D.removeClass(c.ext,"alisearch-current");c.extList.appendChild(c.ext);c.ext=f;c.basicList.appendChild(f)}else{$D.removeClass(c.current,"alisearch-current");c.current=f;$D.addClass(c.current,"alisearch-current");c.ext=f;c.basicList.appendChild(c.current);$D.removeClass(c.extBox,"alisearch-over");d.isExt=1}d.changePlaceholder(g)},"a")},checkSubmit:function(){var d=this,c=this.nodes;$E.addListener(c.form,"submit",function(i){var g=c.input.value.trim(),f=d.categoriesMap[d.getCurrentType()],h=!!f.target?f.target:"_blank";if((g!=="")&&(g!==f.placeholder)){this.setAttribute("target",h);if(!!f.tracelog){aliclick(this,"?tracelog="+f.tracelog)}}else{$E.preventDefault(i);if(f.url===b.location.href.split("?")[0]){c.input.focus();return false}FD.common.goTo(f.url,h);return false}})},initSuggest:function(){var d=this,c;$E.addListener(this.nodes.input,"focus",function(){if(!d.isSuggest){$Y.Get.css("http://style.c.aliimg.com/css/sys/head/autocomplete.css");if(typeof FD.widget.AutoComplete==="undefined"){var e="http://style.c.aliimg.com/js/fdevlib/widget/autocomplete/fdev-autocomplete-min.js",g={onSuccess:function(i){c=setTimeout(f,200)}},h=FD.common.request("jsonp",[e],g)}else{f()}d.isSuggest=1}function f(){FD.widget.AutoComplete.init(d.nodes.suggest,{charset:"gb2312",pX:4,pY:17,pW:35,formName:"alisearch",isAnim:false,isShowShut:false})}})},init:function(){this.nodes={form:$("alisearch-form"),input:$("alisearch-input"),suggest:$("alisearch-container"),basicList:$("alisearch-basic-list"),extList:$("alisearch-ext-list"),extBox:$$(".alisearch-types .alisearch-ext")[0],current:$$("#alisearch-basic-list .alisearch-current")[0],ext:null};this.placeholder();this.basicChangeCategory();this.extChangeCategory();this.checkSubmit();this.initSuggest()},end:0};$E.onDOMReady(function(){a.search.init()})})(window,FD.sys.head);if(!FD.sys.Masthead){FDEV.namespace("FD.sys.Masthead");FYE.onDOMReady(function(){var masthead=FYG("masthead-v4")||FYG("masthead-v5");if(!masthead){return}var $D=FYD,$E=FYE,placeholder="placeholder" in document.createElement("input"),form=FYS("form",masthead,true),searchType=FYS("ul.alisearch-type-v4",masthead,true)||FYS("ul.alisearch-type-v5",masthead,true),searchContainer=$D.getNextSibling(searchType),searchCategory=FYS(">div.alisearch-category-v4",searchContainer,true)||FYS(">div.alisearch-category-v5",searchContainer,true),keywords=FYS("input[name=keywords]",searchContainer,true),searchKeywords=keywords.parentNode,button=FYS("button",searchContainer,true),oldIE=FDEV.env.ua.ie<9,ie6=FDEV.env.ua.ie===6,currentCfg,suggestion;var handlers={placeholderInit:function(){if(placeholder){FYD.removeClass(keywords,"empty");return}$E.on(keywords,"focus",focusHandler);$E.on(keywords,"blur",blurHandler);function focusHandler(e){if($D.hasClass(this,"empty")){this.value=""}$D.removeClass(this,"empty")}function blurHandler(e){var value=this.value.trim();if(value){$D.removeClass(this,"empty");this.value=value}else{$D.addClass(this,"empty");this.value=$D.getAttribute(this,"placeholder")}}},typeInit:function(){var categories=FD.common.toArray(searchCategory.children),links=FYS("a",searchType),currentLi=FYS("li.current",searchType,true);$E.delegate(searchType,"click",typeChangeHandler,"li");FYE.on(links,"click",function(e){FYE.preventDefault(e)});if(currentLi){typeChangeHandler.call(FYS("li.current",searchType,true),undefined,true)}else{if(!placeholder){keywords.focus();keywords.blur()}}categories.forEach(function(category,i){var h3=FYS(">h3",category,true);$E.delegate(category,"click",function(){var attr=$D.getAttribute(category,"dataconfig"),config=eval("("+(attr||"{}")+")");currentCfg=config;FD.common.apply(currentCfg,eval("("+($D.getAttribute(this,"data-config")||"{}")+")"));$D.removeClass(category,"category-hover");$D.removeClass(FYS("li",category),"current");$D.addClass(this,"current");h3.innerHTML=this.innerHTML.trim();configChangeHandler(currentCfg)},"li");if(ie6){$E.delegate(category,"mouseover",function(){$D.addClass(this,"hover")},"li");$E.delegate(category,"mouseout",function(){$D.removeClass(this,"hover")},"li")}});$E.on(categories,"mouseenter",function(){$D.addClass(this,"category-hover")});$E.on(categories,"mouseleave",function(){$D.removeClass(this,"category-hover")});function typeChangeHandler(e,isinit){var li=this,lis,type,attr,config,category;if(!isinit&&$D.hasClass(li,"current")){return}lis=FYS(">li",searchType);$D.removeClass(lis,"current");$D.removeClass(lis,"current-next");$D.addClass(this,"current");$D.addClass($D.getNextSibling(this),"current-next");type=$D.getAttribute(li,"data-type");attr=$D.getAttribute(li,"data-config");config=currentCfg=eval("("+attr+")");category=FYS("."+type,searchCategory,true);if(!$D.getAttribute(category,"dataconfig")){$D.setAttribute(category,"dataconfig",attr)}$D.setStyle(categories,"display","none");if(category){li=FYS("li.current",category,true);if(!li){li=FYS("li",category,true)}currentCfg=config||{};FD.common.apply(currentCfg,eval("("+($D.getAttribute(li,"data-config")||"{}")+")"));$D.addClass(li,"current");FYS("h3",category,true).innerHTML=li.innerHTML.trim();$D.setStyle(category,"display","block");$D.addClass(searchContainer,"alisearch-extend")}else{$D.removeClass(searchContainer,"alisearch-extend")}configChangeHandler(currentCfg)}},suggestionInit:function(){},actionInit:function(){var actions=FYS("button",searchContainer);FYE.on(actions,"mouseover",function(){FYD.addClass(this,"hover")});FYE.on(actions,"mouseout",function(){FYD.removeClass(this,"hover")})},submitInit:function(){form.onsubmit=function(){if(!keywords.value||(!placeholder&&$D.hasClass(keywords,"empty"))){keywords.focus();return false}return true}},iePNGFix:function(){if(ie6){var pngImg=FYS("img.iepngfix",masthead);if(pngImg.length){pngImg.forEach(function(img,i){FYD.setStyle(img,"filter",'progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+img.src+'",sizingMethod="scale");');img.src="http://img.china.alibaba.com/images/common/util/1x1.gif"})}}}};function configChangeHandler(o){$D.setAttribute(keywords,"placeholder",o.placeholder);if(!placeholder){if(!keywords.value.trim()){$D.addClass(keywords,"empty")}if($D.hasClass(keywords,"empty")){keywords.value=$D.getAttribute(keywords,"placeholder")}}form.setAttribute("action",o.action);form.className=o.cls||""}for(var p in handlers){handlers[p]()}})};