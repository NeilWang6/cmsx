("irecom" in FE.sys)||(function(e,i,g){var b=g.dmtrack_pageid=(typeof g.dmtrack_pageid==="undefined")?(new Date()-0+""+Math.floor((Math.random()*1000))):g.dmtrack_pageid,f=Object.prototype.hasOwnProperty,c={},h=[],d={template:null,filter:null,statScene:"",apiUrl:"http://res.1688.com/fly/irecom.do",debug:false,debugUrl:"http://10.20.150.79/fly/irecom.do",datalazyload:false,ctrQueue:[],onTemplateReady:null,onLazyloadReady:null,onSuccess:null,onFailure:null};function a(j,m,l){var k=this;if(!(k instanceof a)){return new a(j,m,l)}k.container=e(j)||e(g.document);k.config=e.extend(true,{},d,l);k.params=e.isPlainObject(m)?m:{};k._init()}e.extend(a.prototype,{_init:function(){var r=this,j={},n=g.location.search.substring(1).toLowerCase(),p,o=i.lastLoginId,l=i.loginId,k=e.util.cookie("ali_beacon_id"),q;try{p=e.unparam(n,"&").memberid}catch(m){}j.uid=p||l||o||k||-1;j.pageid=b;r.params=e.extend(true,{},j,r.params);r.config.debug&&(r.config.apiUrl=r.config.debugUrl);if(r.config.datalazyload){e.use("web-datalazyload",function(){q=r.datalazyload=i.datalazyload;q.bind(r.container,function(){r._request()});q.init()})}else{r._request()}},_request:function(){var j=this;e.ajax({url:j.config.apiUrl,data:j.params,dataType:"jsonp",success:function(k){if(j._isCorrect(k)){j._onCallback(k)}else{j._onFailure()}},error:function(){j._onFailure()}})},_isCorrect:function(m){var k=this,l=k.config,j=false;if(!!m&&m.success&&(m.data.returnCode===0)&&(e.isArray(m.data.data))){if(typeof l.filter==="number"&&l.filter>=1){m.data.data=m.data.data.slice(0,l.filter)}else{if(typeof l.filter==="function"){m.data.data=e.grep(m.data.data,l.filter)}}if(m.data.data.length>0){j=true}}return j},_onCallback:function(l){var j=this,k=j.data=l.data;j._loadTemplate(e.proxy(j,"_renderData"))},_loadTemplate:function(o){var k=this,n=k.data.data,m=k.config,j=k.container,l;if(!m.template){j.html("<p>没有指定渲染模板！</p>")}else{if(l){return o(l)}e.use("web-sweet",function(){m.onTemplateReady&&m.onTemplateReady.call(k,n);l=i.sweet(m.template);o(l)})}},_renderData:function(m){var k=this,n=k.data.data,l=k.config,j=k.container;k.tpl=m;if(k.config.datalazyload){k._datalazyloadHandler()}else{k._renderHandler();l.onSuccess&&l.onSuccess.call(k,n)}},_datalazyloadHandler:function(){var j=this,l=j.data.data,k=j.config;j._renderHandler();k.onLazyloadReady&&k.onLazyloadReady.call(j,l);j.datalazyload.register({containers:j.container});k.onSuccess&&k.onSuccess.call(j,l)},_renderHandler:function(){var k=this,l=k.data.data,j=k.container;tpl=k.tpl;j.html(e(tpl.applyData(l,k)));k._clickstat();k._ctrstat()},_onFailure:function(){var k=this,j=k.container,l=k.config;if(l.onFailure===null){j.html('<p>数据加载失败，请<a target="_self" href="javascript:location.reload();">刷新</a>重试！</p>')}else{l.onFailure.call(j)}},_clickstat:function(){var j=this;j.container.delegate("a[data-clickstat]","mousedown",function(o){var p={},n=e(this).data("clickstat"),l=[],k;n=j._parseObj(n);n.objectId&&(p.objectId=n.objectId);n.alg&&(p.alg=n.alg);n.pid&&(p.pid=n.pid);n.objectType&&(p.objectType=n.objectType);p.page=j.config.statScene;p.recId=j.params.recid;p.st_page_id=b;p.time=new Date().getTime();for(k in p){if(f.call(p,k)){l.push(k+"="+p[k])}}l="?"+l.join("&");e.getScript("http://stat.1688.com/bt/1688_click.html"+l)})},_ctrstat:function(){var j=this,k=j.config.ctrQueue;j.ctrData={};e.each(k,function(l,m){if(j._isCtrBatch(m)){j._sniffBatch(m,l)}else{j.datalazyload.bind(j.container.find(m.selector),function(n){j._ctrRequest(m.param,j._sniffNode(e(n)))})}});e.each(k,function(l,m){if(j._isCtrBatch(m)){j._ctrBatch(m,l)}})},_isCtrBatch:function(k){var j=this;return(!j.config.datalazyload||typeof k.ctrBatch==="undefined"||k.ctrBatch)},_sniffBatch:function(m,k){var j=this,l=j.ctrData;e.isArray(l[k])||(l[k]=[]);l[k]=j._sniffNode(e(m.selector,j.container))},_sniffNode:function(m){var k=this,j=[],l;k.container.find(m).each(function(){l=k._parseObj(e(this).data("ctr"));if(!e.isPlainObject(l)){l={objectId:"",alg:""}}j.push((l.objectId||"")+","+(l.alg||""))});return j},_ctrBatch:function(n,l){var j=this,m=j.ctrData,k=n.size||m[l].length,p=n.start||0;j._ctrRequest(n.param,m[l].slice(p,p+k))},_ctrRequest:function(k,o){var l=this,p=k||{},n=[],j;p.object_ids=o.join(";");p.page_area=l.params.recid;p.ctr_type=l.config.statScene;p.page_id=b;for(j in p){if(f.call(p,j)){n.push(j+"="+p[j])}}n="?"+n.join("&");e.getScript("http://ctr.1688.com/ctr.html"+n)},ctrManual:function(n,k,m,o){var l=this,j=l._sniffNode(n);m=m||j.length;o=o||0;l._ctrRequest(k,j.slice(o,o+m))},_parseObj:function(j){try{return(typeof j==="object")?j:(new Function("return "+j))()}catch(k){return{}}}});a.fitLength=function(k,j){k=e.util.unescapeHTML(k);if(k.lenB()>j){k=k.cut(j-3)+"..."}return e.util.escapeHTML(k)};a.getOfferUrl=function(k){var j=(!!k.eURL)?k.eURL:k.offerDetailUrl;return j};a.getSearchUrl=function(j){var k="http://s.1688.com/search/offer_search.htm?keywords="+j.categoryDesc;return k};a.getCompanyUrl=function(j){var k=j.contact;return k};a.getBizrefUrl=function(k){var m=k.domainID,j=k.memberId,l="";!m||(l="http://"+m+".cn.1688.com/athena/bizreflist/"+m+".html");!j||(l="http://"+j+".cn.1688.com/athena/bizreflist/"+j+".html");return l};a.getPrice=function(k,l){var j="",l=l||0;if([0,""].indexOf(k.rmbPrice)===-1){j='<span class="fd-cny">&yen;</span><em class="value">'+k.rmbPrice+"</em>"+(l?'<span class="unit">/'+k.unit+"</span>":"")}else{if([0,""].indexOf(k.foreignPrice)===-1){j='<em class="value">'+k.foreignPrice+k.foreignCurrency+"</em>"+(l?'<span class="unit">/'+k.unit+"</span>":"")}else{j='<em class="value">价格面议</em>'}}return j};a.getImgUrl=function(m,k){var j=m.offerImageUrl,l=k||100,n="";if(!j){if(l<151){if(l<101){n="http://img.china.alibaba.com/cms/upload/other/nopic-100.png"}else{n="http://img.china.alibaba.com/cms/upload/other/nopic-150.png"}}else{if(l<221){n="http://img.china.alibaba.com/cms/upload/other/nopic-220.png"}else{n="http://img.china.alibaba.com/cms/upload/other/nopic-310.png"}}}else{if(l<151){if(l<101){n=j+".summ.jpg"}else{n=j+".search.jpg"}}else{if(l<221){n=j+".220x220.jpg"}else{n=j+".310x310.jpg"}}}return n};a.p4pSort=function(j){j.sort(function(m,l){var k=(!m.eURL)?1:0,n=(!l.eURL)?1:0;return k-n})};a.resizeImg=function(k,j,n){k.removeAttribute("width");k.removeAttribute("height");var l;if(g.ActiveXObject){l=new Image();l.src=k.src}else{l=k}if(l&&l.width&&l.height&&j){if(!n){n=j}if(l.width>j||l.height>n){var o=l.width/l.height,m=o>=j/n;k[m?"width":"height"]=m?j:n;if(g.ActiveXObject){k[m?"height":"width"]=(m?j:n)*(m?1/o:o)}}}};FE.sys.irecom=a;e.add("sys-irecom")})(jQuery,FE.util,window);