FD.sys.p4p.Utils.debug(false);(function(G,B){var A=YAHOO.lang,F=YAHOO.util.Dom,C=YAHOO.util.Event;B.P4POfferRecommendedView=function(I,E,D,H){E=FD.sys.p4p.Utils.doFitlerData(E);B.P4POfferRecommendedView.superclass.constructor.call(this,E,D,H);this.result=E;this.oP4PConfig=D;this.oMergedP4PConfig=H;this[I]();FD.sys.p4p.Utils.log(E);FD.sys.p4p.Utils.log(D)};A.extend(B.P4POfferRecommendedView,B.AbstractP4PView);A.augmentObject(B.P4POfferRecommendedView.prototype,{onSuccess:function(){FD.sys.p4p.Utils.log("Success:P4POfferRecommendedView");new B.P4POfferRecommendedRender(this.result,"p4poffer",4)},onFailure:function(){FD.sys.p4p.Utils.log("Failure:P4POfferRecommendedView")},onTimeout:function(){},end:0},true);B.P4POfferRecommendedRender=function(E,H,D){this.maxOfferNum=D||4;this.data=E;this.root=document.getElementById(H);if(!this.root){return}this.searchtrace="sale_search_p4phot_offer";this.searchtrace_more="sale_search_p4phot_more";if(typeof window.iPageConfig=="object"&&window.iPageConfig.keywords==""){this.searchtrace="sale_list_p4phot_offer";this.searchtrace_more="sale_list_p4phot_more"}this.morePost=[];if(typeof window.p4pObject=="object"){if(p4pObject.dcatid){this.morePost.push("dcatid="+p4pObject.dcatid)}if(p4pObject.keyword){this.morePost.push("keywords="+p4pObject.keyword)}if(this.morePost.length){this.morePost="?"+this.morePost.join("&")}else{this.morePost=""}}else{this.morePost=""}this.doRender()};A.augmentObject(B.P4POfferRecommendedRender.prototype,{_doRenderHeader:function(){return'<div class="p4p-header"><h3>\u70ed\u95e8\u63a8\u8350</h3><a href="http://view.1688.com/cms/video/zhindex.html?tracelog=p4p_exhibition" target="_blank" class="p4p-m p4p-expo">\u70ed\u95e8\u5c55\u4f1a\u63a8\u8350</a><a href="'+B.API_CONFIG.entrance+'" target="_blank" title="\u6211\u4e5f\u8981\u51fa\u73b0\u5728\u8fd9\u91cc">\u6211\u4e5f\u8981\u51fa\u73b0\u5728\u8fd9\u91cc</a></div>'},_doRenderFooter:function(){return""},_doRenderImage:function(E,D){var H="";if(E.OFFERIMGURL&&E.OFFERIMGURL!=""){H=E.OFFERIMGURL;H=H.replace("summ.jpg","search.jpg")}else{H=B.API_CONFIG.noimg.x150}return'<div class="p4p-pic"><a href="'+E.EURL+'" title="'+FD.sys.p4p.Utils.doReplace(E.TITLE)+'" target="_blank" onmousedown="FD.sys.p4p.Utils.p4pTagClick(\''+E.RESOURCEID+"','"+E.REDKEY+"','819032_1008');SS.aliclick(this,'?searchtrace="+this.searchtrace+'\')"><img src="'+H+'"/></a></div>'},_doRenderTitle:function(E){var D=FD.sys.p4p.Utils;return'<h3><a title="'+D.doReplace(E.TITLE)+'" href="'+E.EURL+'" onmousedown="FD.sys.p4p.Utils.p4pTagClick(\''+E.RESOURCEID+"','"+E.REDKEY+"','819032_1008');SS.aliclick(this,'?searchtrace="+this.searchtrace+'\')" target="_blank" >'+D.doRed(D.doSubstringAo(D.doReplace(E.TITLE),20),E.REDKEY)+"</a></h3>"},_doRenderCompanyName:function(E,D){return""},_doRenderPrice:function(D){if(D.OFFERPRICE==" "){return'<p class="p4p-c6">\u4ef7\u683c\u9762\u8bae</p>'}return"<p><em><b>&yen;</b>"+FD.sys.p4p.Utils.doSubstringAo(D.OFFERPRICE,18)+"</em></p>"},_doRenderWangWang:function(E,D){return'<div class="p4p-ww"><a href="#" alitalk="{id:\''+E.MEMBERID+"'}\" onclick=\"FD.sys.p4p.Utils.p4pClick('"+E.EURL+"')\" onmousedown=\"FD.sys.p4p.Utils.p4pTraceEnquiryClick({toId:'"+E.MEMBERID+"',offerId:'"+E.RESOURCEID+"',source:'1'});SS.aliclick(this,'?searchtrace="+this.searchtrace+'\')" target="_self" class="iconAlitalk"></a></div>'},_doRenderItem:function(I,D){var H=[],E="";if(D==this.maxOfferNum-1){E="p4p-item-fixed"}H.push('<li class="'+E+'">');H.push(this._doRenderImage(I,D));H.push(this._doRenderTitle(I,D));H.push(this._doRenderPrice(I,D));H.push(this._doRenderWangWang(I,D));H.push("</li>");return H.join("")},_doRenderContent:function(E){var D=[];D.push('<ul class="p4p-content">');for(var H=0;H<E.length&&H<this.maxOfferNum;H++){D.push(this._doRenderItem(E[H],H))}D.push("</ul>");return D.join("")},doRender:function(){var E=document.createElement("div");E.id="J_p4pTop";E.className="p4p-search-window";var D=[];D.push(this._doRenderHeader());D.push(this._doRenderContent(this.data));D.push(this._doRenderFooter());E.innerHTML=D.join("");this.root.appendChild(E);new FD.widget.Alitalk(FYS("a[alitalk]","J_p4pTop"),{onRemote:function(){switch(this.opt.online){case 0:case 2:case 6:default:this.innerHTML="\u7ed9\u6211\u7559\u8a00";this.title="\u7ed9\u6211\u7559\u8a00";break;case 1:this.innerHTML="\u548c\u6211\u8054\u7cfb";this.title="\u548c\u6211\u8054\u7cfb";break;case 4:case 5:this.innerHTML="\u7ed9\u6211\u77ed\u4fe1";this.title="\u7ed9\u6211\u77ed\u4fe1";break}},webWW:function(){window.open("http://alitalk.1688.com/","_blank")}})}});B.getP4POfferRecommended=function(){FD.sys.p4p.Ao(window.p4pObject).use(FD.sys.p4p.P4POfferRecommendedView)}})(window,FD.sys.p4p);
