if(window.FE&&(!FE.sys||!FE.sys.Dcms||!FE.sys.Dcms.Drive)){jQuery.namespace("FE.sys.Dcms.Drive");(function(h,o){var a=null,k=null,l=null,j={init:function(){var q=this;q.write=document.write;q.writeln=document.writeln;document.write=function(r){q._reWrite(r)};document.writeln=function(r){q._reWrite(r+"\n")}},reset:function(){if(this.write){document.write=this.write}if(this.writeln){document.writeln=this.writeln}},_innerShiv:function(u){var w,v=document,r,q="abbr article aside audio canvas datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video".split(" ");if(!w){w=v.createElement("div");w.innerHTML="<nav></nav>";r=w.childNodes.length!==1;if(r){var t=document.createDocumentFragment();var s=q.length;while(s--){t.createElement(q[s])}t.appendChild(w)}}w.innerHTML=u;return w.childNodes},handle:function(v,q,z,x){var r=h("<div/>");if(h.type(z)==="boolean"){x=z;z="none"}x=(typeof x!=="undefined")?x:true;r.append(this._innerShiv('<span style="display:none">hack ie</span>'+v));switch(z){case"style":r.find("style").remove();break;case"script":r.find("script").remove();break;case"both":r.find("style, script").remove();break}var t=r.find("script"),w=t.length,s=[];for(var u=0;u<w;u++){var y=t.eq(u),B={};B.parent=y.parent();B.before=this._getBefore(y);B.after=this._getAfter(y);B.src=y.attr("src");B.script=y.html();s.push(B)}t.remove();var A=r.children();if(x){q.replaceWith(A)}else{q.html("").append(A)}this._includeScript(s,0);return A},_reWrite:function(t){var v=document.createElement("div");v.innerHTML=t;var s=v.childNodes,q=s.length;if(l&&l.length!==0){for(var r=0;r<q;r++){var u=h(s[r]);l.after(u);l=u}}else{if(k&&k.length!==0){for(var r=0;r<q;r++){var u=h(s[r]);k.before(u);k=u}}else{if(a&&a.length!==0){a.html(t)}}}},_getBefore:function(t){var s=t.prevAll();for(var r=0,q=s.length;r<q;r++){if(s[r].nodeName.toUpperCase()!=="SCRIPT"){return s.eq(r)}}return h()},_getAfter:function(t){var q=t.nextAll();for(var s=0,r=q.length;s<r;s++){if(q[s].nodeName.toUpperCase()!=="SCRIPT"){return q.eq(s)}}return h()},_includeScript:function(v,u){var q=v.length;if(!(v||u)||u>=q){return}var s=document.createElement("script"),r=this,t=u+1;s.type="text/javascript";a=v[u].parent;k=v[u].after;l=v[u].before;if(v[u].src){s.src=v[u].src;s.onload=s.onreadystatechange=function(){if(!s.readyState||s.readyState==="loaded"||s.readyState==="complete"){if(t<q){r._includeScript(v,t)}s.onload=s.onreadystatechange=null}};n(s)}else{n(s);s.text=v[u].script;if(t<q){r._includeScript(v,t)}}}},i=[function(){f(h(".dcms-position-beacon-js"))},function(){var q=h(".dcms-beacon-position"),r=[];if(q.length>0){q.each(function(t){var u=h(this).data("exposure-id"),s=r.length;if(r[s-1]!==u){r.push(u)}});g(r.join(";"))}b()}];function f(q,r){r=h.extend({},r);q.each(function(u){var v=h(this),t=v.data("url"),s=v.data("deletess");if(t.indexOf("open/error.htm?path=")>-1){d(v,"\u6570\u636e\u5185\u5bb9\u4e3a\u7a7a\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458",t);return}h.ajax({url:t,dataType:"jsonp",success:function(x){if(x&&x.content){j.init();var y=j.handle(x.content,v,s);j.reset();var C=r.success;if(C&&h.isFunction(C)){C.call(y)}if(x.pid&&x.rid&&x.tid){var A=x.pid,D=x.rid,z=x.tid,w="pid="+A+"&rid="+D+"&tid="+z,E=A+","+D+","+z+";";y.filter("a").data("click-param",w);y.find("a").data("click-param",w);g(E);y.filter(".dcms-beacon-position").attr("data-exposure-id",E)}}else{var B=r.error;if(B&&h.isFunction(B)){B.call(v)}else{c(v,"\u6570\u636e\u5185\u5bb9\u4e3a\u7a7a\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458",t)}}},error:function(){var w=r.error;if(w&&h.isFunction(w)){w.call(v)}else{c(v,"\u6570\u636e\u5185\u5bb9\u4e3a\u7a7a\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458",t)}}})})}o.request=f;function p(r){var s=new RegExp("/([^/]+).htm$","g");var q;if((q=s.exec(r))!=null){return q[1]}return""}function c(t,s,r){var q=p(r),u;if(q){if(h("#pos_error_"+q)){u=h.trim(h("#pos_error_"+q).html())}if(u){j.init();var v=j.handle("<div>"+u+"</div>",t,true);j.reset();e(q);return}}t.replaceWith("<div>"+s+"</div>");e(r+"&care=true")}function d(s,r,q){c(s,r,q)}function b(){var q=m();h(".dcms-beacon-position-a").live("mousedown",function(){var u=h(this),v=u.data("click-param"),t=u.attr("href"),r=t.indexOf("?"),s=t.indexOf("#");t=(r!==-1)?t.substring(0,r):t;t=(s!==-1)?t.substring(0,s):t;v+="&url="+t;(new Image).src="http://stat.1688.com/click_dcms.htm?"+v+"&st_page_id="+q})}function g(s){var r=m(),q=document.createElement("script");n(q);q.setAttribute("type","text/javascript");q.src="http://ctr.1688.com/ctr_dcms.html?info="+s+"&page_id="+r}function e(r){var q=document.createElement("script");n(q);q.setAttribute("type","text/javascript");q.src="http://dcms.cn.1688.com/open/pos_error.htm?info="+r}function n(s){var q=document.getElementsByTagName("head")[0],r=h("base",q);(r.length>0)?q.insertBefore(s,r[0]):q.appendChild(s)}function m(){var q;if(window.dmtrack_pageid){q=window.dmtrack_pageid}else{q=""}m=function(){return q};return q}h(function(){for(var r=0,q=i.length;r<q;r++){try{i[r]()}catch(s){if(h.log){h.log("Error at No."+r+"; "+s.name+":"+s.message)}}finally{continue}}})})(jQuery,FE.sys.Dcms.Drive)};
