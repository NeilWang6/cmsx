/*
change by Edgar 110113
http://style.c.aliimg.com/js/lib/fdev-v3/core/yui/get-min.js
http://style.c.aliimg.com/js/sys/opensearch/core/opensearch.js
*/

YAHOO.util.Get=function(){var m={},l=0,r=0,e=false,n=YAHOO.env.ua,s=YAHOO.lang;var j=function(x,t,y){var u=y||window,z=u.document,A=z.createElement(x);for(var v in t){if(t[v]&&YAHOO.lang.hasOwnProperty(t,v)){A.setAttribute(v,t[v])}}return A};var i=function(u,v,t){var w={id:"yui__dyn_"+(r++),type:"text/css",rel:"stylesheet",href:u};if(t){s.augmentObject(w,t)}return j("link",w,v)};var p=function(u,v,t){var w={id:"yui__dyn_"+(r++),type:"text/javascript",async:true,src:u};if(t){s.augmentObject(w,t)}return j("script",w,v)};var a=function(t,u){return{tId:t.tId,win:t.win,data:t.data,nodes:t.nodes,msg:u,purge:function(){d(this.tId)}}};var b=function(t,w){var u=m[w],v=(s.isString(t))?u.win.document.getElementById(t):t;if(!v){q(w,"target node not found: "+t)}return v};var q=function(w,v){var t=m[w];if(t.onFailure){var u=t.scope||t.win;t.onFailure.call(u,a(t,v))}};var c=function(w){var t=m[w];t.finished=true;if(t.aborted){var v="transaction "+w+" was aborted";q(w,v);return}if(t.onSuccess){var u=t.scope||t.win;t.onSuccess.call(u,a(t))}};var o=function(v){var t=m[v];if(t.onTimeout){var u=t.scope||t;t.onTimeout.call(u,a(t))}};var g=function(v,A){var u=m[v];if(u.timer){u.timer.cancel()}if(u.aborted){var y="transaction "+v+" was aborted";q(v,y);return}if(A){u.url.shift();if(u.varName){u.varName.shift()}}else{u.url=(s.isString(u.url))?[u.url]:u.url;if(u.varName){u.varName=(s.isString(u.varName))?[u.varName]:u.varName}}var D=u.win,C=D.document,B=C.getElementsByTagName("head")[0],x;if(u.url.length===0){if(u.type==="script"&&n.webkit&&n.webkit<420&&!u.finalpass&&!u.varName){var z=p(null,u.win,u.attributes);z.innerHTML='YAHOO.util.Get._finalize("'+v+'");';u.nodes.push(z);B.appendChild(z)}else{c(v)}return}var t=u.url[0];if(!t){u.url.shift();return g(v)}if(u.timeout){u.timer=s.later(u.timeout,u,o,v)}if(u.type==="script"){x=p(t,D,u.attributes)}else{x=i(t,D,u.attributes)}f(u.type,x,v,t,D,u.url.length);u.nodes.push(x);if(u.insertBefore){var E=b(u.insertBefore,v);if(E){E.parentNode.insertBefore(x,E)}}else{B.appendChild(x)}if((n.webkit||n.gecko)&&u.type==="css"){g(v,t)}};var k=function(){if(e){return}e=true;for(var t in m){var u=m[t];if(u.autopurge&&u.finished){d(u.tId);delete m[t]}}e=false};var d=function(z){if(m[z]){var t=m[z],u=t.nodes,x=u.length,C=t.win.document,A=C.getElementsByTagName("head")[0],v,y,w,B;if(t.insertBefore){v=b(t.insertBefore,z);if(v){A=v.parentNode}}for(y=0;y<x;y=y+1){w=u[y];if(w.clearAttributes){w.clearAttributes()}else{for(B in w){delete w[B]}}A.removeChild(w)}t.nodes=[]}};var h=function(u,t,v){var x="q"+(l++);v=v||{};if(l%YAHOO.util.Get.PURGE_THRESH===0){k()}m[x]=s.merge(v,{tId:x,type:u,url:t,finished:false,aborted:false,nodes:[]});var w=m[x];w.win=w.win||window;w.scope=w.scope||w.win;w.autopurge=("autopurge" in w)?w.autopurge:(u==="script")?true:false;if(v.charset){w.attributes=w.attributes||{};w.attributes.charset=v.charset}s.later(0,w,g,x);return{tId:x}};var f=function(C,x,w,u,y,z,B){var A=B||g;if(n.ie){x.onreadystatechange=function(){var D=this.readyState;if("loaded"===D||"complete"===D){x.onreadystatechange=null;A(w,u)}}}else{if(n.webkit){if(C==="script"){if(n.webkit>=420){x.addEventListener("load",function(){A(w,u)})}else{var t=m[w];if(t.varName){var v=YAHOO.util.Get.POLL_FREQ;t.maxattempts=YAHOO.util.Get.TIMEOUT/v;t.attempts=0;t._cache=t.varName[0].split(".");t.timer=s.later(v,t,function(I){var F=this._cache,E=F.length,D=this.win,G;for(G=0;G<E;G=G+1){D=D[F[G]];if(!D){this.attempts++;if(this.attempts++>this.maxattempts){var H="Over retry limit, giving up";t.timer.cancel();q(w,H)}else{}return}}t.timer.cancel();A(w,u)},null,true)}else{s.later(YAHOO.util.Get.POLL_FREQ,null,A,[w,u])}}}}else{x.onload=function(){A(w,u)}}}};return{POLL_FREQ:10,PURGE_THRESH:20,TIMEOUT:2000,_finalize:function(t){s.later(0,null,c,t)},abort:function(u){var v=(s.isString(u))?u:u.tId;var t=m[v];if(t){t.aborted=true}},script:function(t,u){return h("script",t,u)},css:function(t,u){return h("css",t,u)}}}();YAHOO.register("get",YAHOO.util.Get,{version:"2.8.1",build:"19"});;
FDEV.namespace("FD.sys.opensearch");(function(b,a){a.ApiConfig={searchApi:"http://service.s.1688.com/search/json_viewer.htm",defaultParams:{fromId:"opensearch",search_type:"offer",type:"sale",keywords:"",imageFlag:1,onlyAlipay:1,onlineStatus:"all",onlyWithPrice:true,distinctField:"userid",distinctCount:1,mlr:true,pagesize:5},end:0};a.Util={log:function(d,c){if(b.console!==undefined&&console.info){console[c&&console[c]?c:"info"](d)}},toFixed:function(d,c){var e=Math.pow(10,c||0);d*=e;d=d.toFixed(c);d=Math.round(d);d/=e;return d.toFixed(c)},resizeImage:function(d,c,g){d.removeAttribute("width");d.removeAttribute("height");var e;if(window.ActiveXObject){e=new Image();e.src=d.src}else{e=d}if(e&&e.width&&e.height&&c){if(!g){g=c}if(e.width>c||e.height>g){var i=e.width/e.height,f=i>=c/g;if(window.ActiveXObject){d=d.style}d[f?"width":"height"]=f?c:g;if(window.ActiveXObject){d[f?"height":"width"]=(f?c:g)*(f?1/i:i)}}}},getOfferDetailUrl:function(c){if(c!==""){return"http://detail.1688.com/buyer/offerdetail/"+c+".html"}},getOfferSearchUrl:function(j,n,d,g,o){var i="",m="",e="",h="",l="";if(typeof j==="string"&&j!==""){i="k-"+j}if(typeof n==="string"&&n!==""){e=n.split(" ");if(e.length>=1){m="c-"+e[0]+"_"}}if(typeof g==="boolean"&&g){h="entrance-etc_"}if(typeof o==="string"&&o!==""){l="_f-"+o.replace("_",":")}if(i!==""||m!==""){return"http://s.1688.com/business/"+i+"_"+m+"p-1"+l+"_fromOfferId-"+d+"_"+h+"n-y.html"}else{return this.getOfferDetailUrl(d)}},getOfferUrl:function(j,h,f,e,i,g,d){var c;if(h||j==="detail"){c=this.getOfferDetailUrl(i)}else{c=this.getOfferSearchUrl(f,e,i,g,d)}return c},getOfferImgUrl:function(g,d,c){var d=d||0,h=["http://img.china.alibaba.com/images/sys/lock/100x100.jpg","http://img.china.alibaba.com/images/sys/lock/150x150.jpg","http://img.china.alibaba.com/images/sys/lock/220x220.jpg","http://img.china.alibaba.com/images/sys/lock/310x310.jpg"],f=["http://img.china.alibaba.com/images/cn/p4p/nopic_100x100.gif","http://img.china.alibaba.com/images/cn/market/trade/list/070423/nopic150.gif","http://img.china.alibaba.com/images/cn/market/trade/list/070423/nopic150.gif","http://img.china.alibaba.com/images/cn/market/trade/list/070423/nopic150.gif"];if(c&&c!==2){return h[d]}if(g===""){return f[d]}if(g&&g.indexOf("http")){g="http://"+g}var e=[".summ.jpg",".search.jpg",".220x220.jpg",".310x310.jpg"];return g+e[d]},getCompanyUrl:function(c,d,e){if(c==="1"||c==="2"){if(d!==""){return"http://"+d+".cn.1688.com"}else{return"http://"+e+".cn.1688.com"}}else{return"http://company.1688.com/athena/"+e+".html"}},tracelog:function(c){function d(e,g){if(typeof window.dmtrack!="undefined"){dmtrack.clickstat(e,g)}else{var f=new Date();if(document.images){(new Image).src=e+g+"&time="+f.getTime()}}return true}return d("http://stat.1688.com/tracelog/click.html","?tracelog="+c)},end:0};a.theme={};a.OpenSearchModule=function(d,c,e){this.openSearchConfig=FD.common.applyIf(d,a.ApiConfig.defaultParams);this.appCustomize=c;this.openSearchApp=e=function(i,h,g,f){this.result=h||{};this.openSearchConfig=g;this.appCustomize=f;this.appCustomize.imgType=(this.appCustomize.imgType&&(this.appCustomize.imgType-0)<4)?(this.appCustomize.imgType-0):1;if(this.appCustomize.theme&&a.theme[this.appCustomize.theme]&&typeof a.theme[this.appCustomize.theme]==="object"){if(this.appCustomize.containerId&&$(this.appCustomize.containerId)){this[i]()}else{a.Util.log("missing containerId!","warn")}}else{a.Util.log("missing theme: "+this.appCustomize.theme+"!","warn")}};this.load();this.openSearchApp.prototype={onSuccess:function(){if(!FDEV.lang.isObject(this.result)){return}if(this.result.searchResultCount!==0&&this.result.searchResultList.length!==0){a.theme[this.appCustomize.theme].getHtmlRoot(this.result,this.appCustomize,this.openSearchConfig)}else{this.onFailure()}},onFailure:function(){a.theme[this.appCustomize.theme].getErrorTips(this.appCustomize,"failure")},onTimeout:function(){a.theme[this.appCustomize.theme].getErrorTips(this.appCustomize,"timeout")},onProgress:function(){a.theme[this.appCustomize.theme].getErrorTips(this.appCustomize,"progress")},end:0}};a.OpenSearchModule.prototype={load:function(){var c=this.getLoadUrl();var e={onSuccess:this.onSuccess,onFailure:this.onFailure,onTimeout:this.onTimeout,onProgress:this.onProgress,scope:this,timeout:5000,charset:"gb2312",data:{}};var d=FDEV.util.Get.script(c,e)},getLoadUrl:function(){var c=a.ApiConfig.searchApi+"?"+this.getParamsString();return c},getParamsString:function(){var c=this.openSearchConfig,e=[];for(var d in c){e.push(d+"="+c[d])}return e.join("&")},onSuccess:function(){var c={};c=window[this.openSearchConfig.returnJsonObjectName];this.toDo("onSuccess",c)},onFailure:function(){this.toDo("onFailure",{})},onTimeout:function(){this.toDo("onTimeout",{})},onProgress:function(){this.toDo("onProgress",{})},toDo:function(d,c){new this.openSearchApp(d,c,this.openSearchConfig,this.appCustomize)},end:0};a.Ao=function(d,c){var e=this;if(!(e instanceof arguments.callee)){return new arguments.callee(d,c)}return{use:function(f){new a.OpenSearchModule(d,c,f)},end:0}}})(window,FD.sys.opensearch);;