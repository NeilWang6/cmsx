(function(){FYU.EnBeacon=function(c){this.init(c)};var a=FD.SWFStore,b=FYU.EnBeacon;b.defConfig={send_to:"http://abtest.china.alibaba.com/rr.gif",with_timestamp:true,asid_name:"AS_CLIENT_ID",data:{flag:1},send_after_storage_init:false};b.prototype={init:function(e){var d=b.defConfig,f=(new Date()).valueOf();if(e&&e.data){e.data=FD.common.applyIf(e.data,d.data)}this._data={};this._t=f;this.config=FD.common.applyIf(e||{},b.defConfig);var h=this.config.data;for(var g in h){if(h[g]!=Object.prototype[g]){this._data[g]=h[g]}}var c=this._getCookie("ali_beacon_id");if(c){this._beaconId=c}if(swfobject.hasFlashPlayerVersion("9")){this._initStorage()}this.send()},send:function(){var c=new Image();c.src=this.config.send_to+this._getQueryStr()},setData:function(d,c){this._data[d]=c},_initStorage:function(){FD.widget.Flash.init(null,{url:"http://img.china.alibaba.com/swfapp/swfstore/swf-mini-beacon.swf",width:1,height:1,flashvars:{data:"<data cid='"+this._beaconId+"'"+(this._data.tid?" tid='"+this._data.tid+"'":"")+" flag='2' t='"+this._t+"' />"}}).write()},_getQueryStr:function(){var f=this._data,d="";if(this.config.with_timestamp){f.t=this._t}if(this._storageSt){f.sst=this._storageSt}if(this._asid){f.asid=this._asid}if(this._beaconId){f.cid=this._beaconId}var c=swfobject.getFlashPlayerVersion();if(c.major>0){f.fpv=[c.major,c.minor,c.release].join(".")}for(var e in f){if(f[e]!=Object.prototype[e]){d+="&"+e+"="+encodeURIComponent(f[e])}}d=d.replace(/^&/,"?");return d},_getCookie:function(c){var d=document.cookie.match("(?:^|;)\\s*"+c+"=([^;]*)");return d?unescape(d[1]):""}}})();
