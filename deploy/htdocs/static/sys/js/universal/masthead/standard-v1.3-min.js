(function(e,a){var d=function(g){g.init()},c=function(h){var i="http://{h}/{type}/sys/universal/masthead/{name}.{type}?v={v}",g=e.util.substitute;e.loadCSS(g(i,{h:e.styleDomain,name:h+"-v1.3",type:"css",v:"1.3"}));e.getScript(g(i,{h:e.styleDomain,name:h+"-v1.3",type:"js",v:"1.3"}))},b=function(g){var h=this;if("string"===typeof g){c(g);return}e.each(g,function(j,k){e(document).ready(function(){d(k)})})};a.masthead={SEARCH_TYPE_MAP:{combo:{url:"http://s.1688.com/combo/index.htm",action:"http://s.1688.com/search/smart_search.htm",placeholder:"输入关键词"},product:{url:"http://page.1688.com/buy/index.html",action:"http://s.1688.com/search/offer_search.htm",placeholder:"输入产品名称"},company:{url:"http://page.1688.com/cp/cp1.html",action:"http://s.1688.com/search/company_search.htm",placeholder:"输入公司名称或关键词"},buy:{url:"http://page.1688.com/cp/cp8.html",action:"http://s.1688.com/search/search.htm",placeholder:"输入产品名称"},baike:{url:"http://baike.1688.com/",action:"http://s.1688.com/search/wiki_answer_search.htm",placeholder:"输入问题关键词"},pifa:{url:"http://pifa.1688.com/",action:"http://s.1688.com/search/business_search.htm",placeholder:"输入产品名称"},trust:{url:"http://page.1688.com/trust/safeguard.html",action:"http://trust.china.alibaba.com/athena/trustsearch.html",placeholder:"输入公司名称或关键词"},info:{url:"http://info.1688.com/",action:"http://s.1688.com/search/news_search.htm",placeholder:"输入信息关键词"},club:{url:"http://club.1688.com/",action:"http://s.1688.com/search/forum_search.htm",placeholder:"输入信息关键词"},blog:{url:"http://blog.1688.com/",action:"http://s.1688.com/search/blog_search.htm",placeholder:"输入信息关键词"},video:{url:"http://video.1688.com/",action:"http://video.1688.com/video/search/search_list.html",placeholder:"输入信息关键词"}}};var f={init:function(){this.$form=e("#alisearch-form");if(!this.$form.length){return}this.$input=e("#alisearch-input");this.$suggest=e("#alisearch-container");this.$basicList=e("#alisearch-basic-list");this.$extList=e("#alisearch-ext-list");this.$extBox=e("#alisearch-form div.alisearch-ext");this.$current=e("#alisearch-basic-list .alisearch-current");this.$ext=null;this.isFocus=0;this.isExt=0;this._placeholder();this._basicTypeSwitch();this._extTypeSwitch();this._checkSubmit();this._suggestion()},_isPlaceholder:function(){return !!("placeholder" in document.createElement("input"))},_getCurrentType:function(){var h=this.$current,g;if(!h.length){h=e("#alisearch-basic-list li:first");h.addClass("alisearch-current")}g=h.attr("data-alisearch-type").trim();return g},_addInputValue:function(g){var h=this.$input,g=g||a.masthead.SEARCH_TYPE_MAP[this._getCurrentType()]["placeholder"];h.addClass("placeholder");h.val(g)},_supportPlaceholder:function(){var h=this,g;this.$input.bind("focus.placeholder",function(){clearTimeout(g);var i=e(this);if(i.hasClass("placeholder")){i.val("");i.removeClass("placeholder")}h.isFocus=1}).bind("blur.placeholder",function(){var i=e(this);if(i.val().trim()===""){h._addInputValue()}g=setTimeout(function(){h.isFocus=0},200)})},_placeholder:function(){var k=this.$input,g=this.$form,h=this._isPlaceholder(),i=this._getCurrentType(),j=a.masthead.SEARCH_TYPE_MAP[i];g.attr("action",j.action);if(this.isFocus){k.focus()}else{if(h){k.attr("placeholder",j.placeholder)}else{this._addInputValue(j.placeholder);this._supportPlaceholder()}}},_changePlaceholder:function(h){var i=a.masthead.SEARCH_TYPE_MAP[h],j=i.placeholder,k=this.$input,g=this.$form;k.attr("placeholder",j);g.attr("action",i.action);if(k.hasClass("placeholder")){k.val(j)}if(this.isFocus){k.focus()}},_basicTypeSwitch:function(){var g=this;this.$basicList.delegate("a","click.switch",function(i){i.preventDefault();var j=e(this).closest("li"),h=j.attr("data-alisearch-type").trim();if(j[0]===g.$current[0]){return}g.$current.removeClass("alisearch-current");g.$current=j;g.$current.addClass("alisearch-current");g._changePlaceholder(h)})},_getIsExt:function(){if(["info","club","blog","vide"].indexOf(this._getCurrentType())>-1){this.isExt=1;this.$ext=this.$current}},_searchEnter:function(){var h,g;this.$extBox.bind("mouseenter.mast",function(){clearTimeout(g);var i=e(this);h=setTimeout(function(){i.addClass("alisearch-over")},200)}).bind("mouseleave.mast",function(){clearTimeout(h);var i=e(this);g=setTimeout(function(){i.removeClass("alisearch-over")},200)});e("#alisearch-more").click(function(i){i.preventDefault();return false})},_extTypeSwitch:function(){var g=this;this._searchEnter();this._getIsExt();this.$extList.delegate("a","click.switch",function(i){i.preventDefault();var j=e(this).closest("li"),h=j.attr("data-alisearch-type").trim();if(g.isExt){g.$current.removeClass("alisearch-current");g.$current=j;g.$current.addClass("alisearch-current");g.$basicList.append(g.$current);g.$ext.removeClass("alisearch-current");g.$extList.append(g.$ext);g.$ext=j}else{g.$current.removeClass("alisearch-current");g.$current=j;g.$current.addClass("alisearch-current");g.$basicList.append(g.$current);g.$extBox.removeClass("alisearch-over");g.$ext=j;g.isExt=1}g._changePlaceholder(h)})},_checkSubmit:function(){var g=this;this.$form.bind("submit.mast",function(k){var h=g.$input.val().trim(),j=a.masthead.SEARCH_TYPE_MAP[g._getCurrentType()],i=!!j.target?j.target:"_blank";if((h!=="")&&(h!==j.placeholder)){e(this).attr("action",j.action);e(this).attr("target",i);if(!!j.tracelog&&"undefined"!==typeof aliclick){aliclick(this,"?tracelog="+j.tracelog)}}else{k.preventDefault();if(j.url===window.location.href.split("?")[0]){g.$input.focus();return false}FE.util.goTo(j.url,i);return false}})},_suggestion:function(){this.$input.one("focus.get",function(){b("suggestion")})}};b([f])})(jQuery,FE.sys);if(!FE.sys.Masthead){jQuery.namespace("FE.sys.Masthead");jQuery(function($){var masthead=$("#masthead-v4,#masthead-v5");if(!masthead.length){return}var form=$("form",masthead),searchType=$("ul.alisearch-type-v4,ul.alisearch-type-v5",masthead),searchContainer=searchType.next(),searchCategory=$(">div.alisearch-category-v4,>div.alisearch-category-v5",searchContainer),keywords=$("input[name=keywords]",searchContainer),searchKeywords=keywords.parent(),submit=$("button:first",searchContainer),ie6=$.util.ua.ie6,currentCfg,suggestion;var handlers={placeholderInit:function(){if($.support.placeholder){keywords.removeClass("empty");return}keywords.bind({focus:focusHandler,blur:blurHandler});function focusHandler(e){if($(this).hasClass("empty")){this.value=""}$(this).removeClass("empty")}function blurHandler(e){var value=this.value.trim();if(value){$(this).val(value).removeClass("empty")}else{$(this).val($(this).attr("placeholder")).addClass("empty")}}},typeInit:function(){var categories=searchCategory.children(),currentLi=searchType.find("li.current").get(0);searchType.delegate("li","click",typeChangeHandler);$("a",searchType).click(function(e){e.preventDefault()});if(currentLi){typeChangeHandler.call(currentLi,$.Event("click"),true)}else{if(!$.support.placeholder){keywords.triggerHandler("focus");keywords.triggerHandler("blur")}}categories.each(function(i,category){var h3=$(category).children("h3");$(category).delegate("li","click",function(){var config=$(category).data("config");currentCfg=$.extend({},config,eval("("+($(this).data("config")||"{}")+")"));$(category).removeClass("category-hover").find("li").removeClass("current");h3.text($(this).addClass("current").text());configChangeHandler(currentCfg)});if(ie6){$(category).delegate("li","mouseover",function(){$(this).addClass("hover")}).delegate("li","mouseout",function(){$(this).removeClass("hover")})}});categories.hover(function(){$(this).addClass("category-hover")},function(){$(this).removeClass("category-hover")});function typeChangeHandler(e,isinit){var li=$(this),type,config,category;if(!isinit&&li.hasClass("current")){return}$(">li",searchType).removeClass("current current-next");$(this).addClass("current").next().addClass("current-next");type=li.data("type");config=currentCfg=eval("("+li.data("config")+")");category=categories.filter("."+type);if(!category.data("config")){category.data("config",config)}categories.hide();if(category.length){li=$("li.current",category);if(!li.length){li=$("li:first",category)}currentCfg=$.extend({},config,eval("("+li.data("config")+")"));category.children("h3").text(li.addClass("current").text()).end().show();searchContainer.addClass("alisearch-extend")}else{searchContainer.removeClass("alisearch-extend")}configChangeHandler(currentCfg)}},suggestionInit:function(){$.add("web-suggestion",{requires:["ui-autocomplete"],js:["suggestion.js"]});keywords.bind("focus.suggestion",function(){if(currentCfg&&currentCfg.suggest){$.use("web-suggestion",function(){suggestion=new FE.ui.Suggestion(keywords,{appendTo:searchKeywords,url:currentCfg.url,type:currentCfg.type,position:{my:"left top",at:"left bottom",offset:"-5 0"},widthfix:8,onSelected:function(e,ui){submit.click()}})});keywords.unbind("focus.suggestion")}})},actionInit:function(){$("button",searchContainer).hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")})},submitInit:function(){form.get(0).onsubmit=function(){if(!keywords.val()||(!$.support.placeholder&&keywords.hasClass("empty"))){keywords.focus();return false}return true}},iePNGFix:function(){if(ie6){var pngImg=$("img.iepngfix",masthead);if(pngImg.length){pngImg.each(function(i,img){$(img).css("filter",'progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+img.src+'",sizingMethod="scale");');img.src="http://img.china.alibaba.com/images/common/util/1x1.gif"})}}}};function configChangeHandler(o){keywords.attr("placeholder",o.placeholder);if(!$.support.placeholder){keywords.triggerHandler("focus");keywords.triggerHandler("blur")}if(suggestion){if(o.suggest){suggestion.setOptions({url:o.url,type:o.type}).enable()}else{suggestion.disable()}}form.removeClass().addClass(o.cls).attr("action",o.action)}for(var p in handlers){handlers[p]()}})};
